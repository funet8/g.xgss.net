(window.webpackJsonp=window.webpackJsonp||[]).push([[106],{693:function(t,a,e){"use strict";e.r(a);var s=e(17),n=Object(s.a)({},(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"apollo多环境以及集群配置-本地测试服务器"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#apollo多环境以及集群配置-本地测试服务器"}},[t._v("#")]),t._v(" Apollo多环境以及集群配置-本地测试服务器")]),t._v(" "),e("h2",{attrs:{id:"一-前言"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#一-前言"}},[t._v("#")]),t._v(" 一. 前言")]),t._v(" "),e("p",[t._v("基于Linux搭建开源配置管理中心后，本篇文档是Apollo的多环境以及集群配置")]),t._v(" "),e("h2",{attrs:{id:"二-环境和准备"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#二-环境和准备"}},[t._v("#")]),t._v(" 二. 环境和准备")]),t._v(" "),e("p",[t._v("还是上文中的虚拟机基本配置：java8，apollo 1.9等")]),t._v(" "),e("h3",{attrs:{id:"apollo相关节点"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#apollo相关节点"}},[t._v("#")]),t._v(" apollo相关节点")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"center"}},[t._v("环境")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("地址")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("服务名")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("后台")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.1.3:8070")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("apollo-portal")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("DEV")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.1.3:8080"),e("br"),t._v("192.168.1.3:8090")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("apollo-configservice"),e("br"),t._v("apollo-adminservice")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("PRO")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.1.2:8081"),e("br"),t._v("192.168.1.2:8091")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("apollo-configservice"),e("br"),t._v("apollo-adminservice")])])])]),t._v(" "),e("h3",{attrs:{id:"数据库配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#数据库配置"}},[t._v("#")]),t._v(" 数据库配置：")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"center"}},[t._v("环境")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("地址")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("数据库名称")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("后台")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.1.10:61920")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("ApolloPortalDB")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("DEV")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.1.10:61920")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("ApolloConfigDB")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("PRO")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.1.10:61920")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("ApolloConfigDBPro")])])])]),t._v(" "),e("h2",{attrs:{id:"三-修改相关配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#三-修改相关配置"}},[t._v("#")]),t._v(" 三. 修改相关配置")]),t._v(" "),e("p",[t._v("数据库如图")]),t._v(" "),e("p",[e("img",{attrs:{src:"images/image-20220413154521556-16498359494921.png",alt:"image-20220413154521556"}})]),t._v(" "),e("p",[t._v("添加portal数据库相关环境配置")]),t._v(" "),e("p",[t._v("在ApolloPortalDB数据库的ServerConfig表中，添加字段 apollo.portal.envs 添加  dev,pro。")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://imgoss.xgss.net/picgo/image-20220413154755350.png?aliyun",alt:"image-20220413154755350"}})]),t._v(" "),e("p",[t._v("添加portal相关meta相关配置")]),t._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("vi /data/wwwroot/web/apollo-1.9.2-github/apollo-portal-1.9.2-github/config/apollo-env.properties\n\ndev.meta=http://192.168.1.3:8080\npro.meta=http://192.168.1.3:8081\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br")])]),e("p",[t._v("其他环境的"),e("strong",[t._v("config")]),t._v("服务和"),e("strong",[t._v("admin")]),t._v("服务注意修改对应数据库连接。")]),t._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("cd /data/wwwroot/web/apollo-1.9.2-github\nmkdir pro\ncp -a apollo-adminservice-1.9.2-github pro/\ncp -a apollo-configservice-1.9.2-github/ pro/\ncd pro\n\nvi /data/wwwroot/web/apollo-1.9.2-github/pro/apollo-adminservice-1.9.2-github/config/application-github.properties \n将 ApolloConfigDB 改为 ApolloConfigDBPro\nvi /data/wwwroot/web/apollo-1.9.2-github/pro/apollo-adminservice-1.9.2-github/config/app.properties\n将 appId=100003172 改成  appId=100003175\n\nvi /data/wwwroot/web/apollo-1.9.2-github/pro/apollo-adminservice-1.9.2-github/scripts/startup.sh\n将端口8090 改为 8091 \nLOG_DIR=/opt/logs/100003175\n启动\n\n# vi /data/wwwroot/web/apollo-1.9.2-github/pro/apollo-configservice-1.9.2-github/config/application-github.properties \n将 ApolloConfigDB 改为 ApolloConfigDBPro\n# vi /home/data/wwwroot/web/apollo-1.9.2-github/pro/apollo-configservice-1.9.2-github/config/app.properties\nappId=100003172 改成 appId=100003176\n# vi /home/data/wwwroot/web/apollo-1.9.2-github/pro/apollo-configservice-1.9.2-github/\nLOG_DIR=/opt/logs/100003172\n## Adjust server port if necessary\nSERVER_PORT=${SERVER_PORT:=8081}\n\n\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br"),e("span",{staticClass:"line-number"},[t._v("14")]),e("br"),e("span",{staticClass:"line-number"},[t._v("15")]),e("br"),e("span",{staticClass:"line-number"},[t._v("16")]),e("br"),e("span",{staticClass:"line-number"},[t._v("17")]),e("br"),e("span",{staticClass:"line-number"},[t._v("18")]),e("br"),e("span",{staticClass:"line-number"},[t._v("19")]),e("br"),e("span",{staticClass:"line-number"},[t._v("20")]),e("br"),e("span",{staticClass:"line-number"},[t._v("21")]),e("br"),e("span",{staticClass:"line-number"},[t._v("22")]),e("br"),e("span",{staticClass:"line-number"},[t._v("23")]),e("br"),e("span",{staticClass:"line-number"},[t._v("24")]),e("br"),e("span",{staticClass:"line-number"},[t._v("25")]),e("br"),e("span",{staticClass:"line-number"},[t._v("26")]),e("br")])]),e("p",[t._v("启动pro服务")]),t._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("sh  /home/data/wwwroot/web/apollo-1.9.2-github/pro/apollo-configservice-1.9.2-github/scripts/startup.sh\n\nsh  /home/data/wwwroot/web/apollo-1.9.2-github/pro/apollo-adminservice-1.9.2-github/scripts/startup.sh \n\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br")])]),e("p",[t._v("https://blog.csdn.net/weixin_41133233/article/details/121833878")])])}),[],!1,null,null,null);a.default=n.exports}}]);