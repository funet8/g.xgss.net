(window.webpackJsonp=window.webpackJsonp||[]).push([[118],{706:function(s,a,n){"use strict";n.r(a);var e=n(17),t=Object(e.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"linux搭建开源企业邮箱系统ewomail"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#linux搭建开源企业邮箱系统ewomail"}},[s._v("#")]),s._v(" Linux搭建开源企业邮箱系统EwoMail")]),s._v(" "),n("h2",{attrs:{id:"ewomail是什么"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ewomail是什么"}},[s._v("#")]),s._v(" EwoMail是什么")]),s._v(" "),n("p",[s._v("EwoMail是基于Linux的开源邮件服务器软件，集成了众多优秀稳定的组件，是一个快速部署、简单高效、多语言、安全稳定的邮件解决方案，帮助你提升运维效率，降低 IT 成本，兼容主流的邮件客户端，同时支持电脑和手机邮件客户端。")]),s._v(" "),n("h2",{attrs:{id:"项目文档"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#项目文档"}},[s._v("#")]),s._v(" 项目文档")]),s._v(" "),n("p",[s._v("开源项目：https://gitee.com/laowu5/EwoMail")]),s._v(" "),n("p",[s._v("官方文档：http://doc.ewomail.com/docs/ewomail/jianjie")]),s._v(" "),n("h2",{attrs:{id:"服务器环境-腾讯云"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#服务器环境-腾讯云"}},[s._v("#")]),s._v(" 服务器环境（腾讯云）")]),s._v(" "),n("p",[s._v("前期准备，需要域名，国内需要备案")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("需求centos7/8 64位系统\n172.21.0.15（内）\n49.232.171.74（公网）\ncentos7+1核+1G+40G\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("p",[n("img",{attrs:{src:"https://imgoss.xgss.net/picgo/email-EwoMail.jpg?aliyun",alt:"email-EwoMail"}})]),s._v(" "),n("h1",{attrs:{id:"系统初始化"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#系统初始化"}},[s._v("#")]),s._v(" 系统初始化")]),s._v(" "),n("p",[s._v("适当运行脚本")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("新建常用文件路径\nwget https://raw.githubusercontent.com/funet8/centos6_LANP_dockerfile/master/shell/create_dir.sh\n\n初始化系统脚本\nwget https://raw.githubusercontent.com/funet8/centos6_LANP_dockerfile/master/shell/CentOS7.x_system_init_shell_mini.sh\n重新登陆服务器要改端口 60920\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("h1",{attrs:{id:"腾讯云解封25端口"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#腾讯云解封25端口"}},[s._v("#")]),s._v(" 腾讯云解封25端口")]),s._v(" "),n("p",[s._v("https://cloud.tencent.com/document/product/213/40436")]),s._v(" "),n("h1",{attrs:{id:"新建swap分区"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#新建swap分区"}},[s._v("#")]),s._v(" 新建SWAP分区")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("#内存为32G以上则不考虑 \n#内存在16G至32G之间，交换分区配置为8G\n#内存在4G至16G之间，交换分区配置为4G \n#内存小于4G的则配置交换分区为2G \n\n安装前\n# free -m\n              total        used        free      shared  buff/cache   available\nMem:            991         164          73           0         752         683\nSwap:             0           0           0\n\n\n# wget https://gitee.com/funet8/centos6_LANP_dockerfile/raw/master/shell/aliyun_swap.sh\n修改 size_block 变量\n# sh aliyun_swap.sh\n\n安装后\n# free -m\n              total        used        free      shared  buff/cache   available\nMem:            991         162          61           0         767         686\nSwap:          2047           0        2047\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br")])]),n("h1",{attrs:{id:"安装ewomail开源版"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#安装ewomail开源版"}},[s._v("#")]),s._v(" 安装ewomail开源版")]),s._v(" "),n("h2",{attrs:{id:"git安装-centos7-8"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#git安装-centos7-8"}},[s._v("#")]),s._v(" git安装 （centos7/8）")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("yum -y install git\ncd /root\ngit clone https://gitee.com/laowu5/EwoMail.git\ncd /root/EwoMail/install\n#需要输入一个邮箱域名，不需要前缀，列如下面的 your-domain.com\nsh ./start.sh your-domain.com\n\n# firewall-cmd --zone=public --add-port=60920/tcp --permanent\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("h2",{attrs:{id:"遇到的登陆不了ssh的问题"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#遇到的登陆不了ssh的问题"}},[s._v("#")]),s._v(" 遇到的登陆不了ssh的问题")]),s._v(" "),n("p",[s._v("由于初始脚本中使用的是iptables的策略，而ewomail开源策略使用的是firewall-cmd导致无法登陆。")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("开放ssh端口：\n# firewall-cmd --zone=public --add-port=60920/tcp --permanent\n重启防火墙：\n# firewall-cmd --reload\n# iptables -nL\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("h2",{attrs:{id:"访问地址-将ip更换成你服务器ip即可"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#访问地址-将ip更换成你服务器ip即可"}},[s._v("#")]),s._v(" 访问地址（将IP更换成你服务器IP即可）")]),s._v(" "),n("p",[s._v("邮箱管理后台："),n("a",{attrs:{href:"http://49.232.171.74:8010/",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://49.232.171.74:8010"),n("OutboundLink")],1),s._v(" （默认账号admin，密码ewomail123）")]),s._v(" "),n("p",[s._v("web邮件系统："),n("a",{attrs:{href:"http://49.232.171.74:8000/",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://49.232.171.74:8000"),n("OutboundLink")],1)]),s._v(" "),n("p",[s._v("phpmyadmin："),n("a",{attrs:{href:"http://49.232.171.74:8020/",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://49.232.171.74:8020/"),n("OutboundLink")],1)]),s._v(" "),n("h1",{attrs:{id:"常规配置-视情况操作"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#常规配置-视情况操作"}},[s._v("#")]),s._v(" 常规配置（视情况操作）")]),s._v(" "),n("p",[s._v("http://doc.ewomail.com/docs/ewomail/changguipeizhi")]),s._v(" "),n("h2",{attrs:{id:"修改密码"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#修改密码"}},[s._v("#")]),s._v(" 修改密码")]),s._v(" "),n("p",[s._v("登陆：http://IP:8010 ， 点击”个人资料”进行修改。")]),s._v(" "),n("h2",{attrs:{id:"修改资料"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#修改资料"}},[s._v("#")]),s._v(" 修改资料")]),s._v(" "),n("p",[s._v("修改后台标题，备案资料，语言种类等等。。")]),s._v(" "),n("h2",{attrs:{id:"webmail修改端口"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#webmail修改端口"}},[s._v("#")]),s._v(" webmail修改端口")]),s._v(" "),n("p",[s._v("nginx 配置文件 /ewomail/nginx/conf/vhost/rainloop.conf")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("vi /ewomail/nginx/conf/vhost/rainloop.conf\n将8000改为80\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h2",{attrs:{id:"ssl证书"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ssl证书"}},[s._v("#")]),s._v(" SSL证书")]),s._v(" "),n("p",[s._v("不需要")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("操作的时候请备份要替换的配置文件\n\nwebmail的https\n复制/ewomail/nginx/conf/vhost/rainloop.conf.ssl 替换rainloop.conf\n\n1、系统自带了本地SSL证书，imap,smtp,nginx都会使用它，你可以默认也使用，安装的时候根据你的域名生成。\n2、使用互联网经过认证的证书，将你申请生成的nginx证书替换以下2个文件\n\n公匙 /etc/ssl/certs/dovecot.pem\n私匙 /etc/ssl/private/dovecot.pem\n\n如果你使用默认本地证书，就不用进行替换，复制文件替换后就可以了。\n\n最后执行命令重启\nservice nginx restart\nsystemctl restart postfix dovecot\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br")])]),n("h2",{attrs:{id:"mysql优化配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#mysql优化配置"}},[s._v("#")]),s._v(" mysql优化配置")]),s._v(" "),n("p",[s._v("1.06版本默认mysql是针对1G内存以下进行优化的，如果你服务器内存大于1G，请以下操作")]),s._v(" "),n("p",[s._v("将 /ewomail/mysql/etc/my-huge.cnf 替换 /ewomail/mysql/etc/my.cnf")]),s._v(" "),n("p",[s._v("重启mysql")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("service mysqld restart\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h2",{attrs:{id:"mysql数据库"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#mysql数据库"}},[s._v("#")]),s._v(" mysql数据库")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("忘记管理员\n\n如果忘记管理员密码，需要进入数据库修改。\n\n查看数据库密码\n\n进入服务器执行命令：cat /ewomail/config.ini\n\n# cat /ewomail/config.ini\ndomain：your-domain.com\nmysql-root-password：ybXkgm7T944sO***** （星号处理）\nmysql-ewomail-password：wIm9Hb9Yi******\n\n打开http://IP:8020 （ewomail默认安装了phpmyadmin，为了安全，可以关闭或更换端口）\n打开ewomail数据库，找到i_admin表，将password改为3bb3733de472b226208307ec1e689347\n这样就可以把密码改回ewomail123，重新使用默认账号和密码登录即可。\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br")])]),n("h1",{attrs:{id:"域名解析-重要"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#域名解析-重要"}},[s._v("#")]),s._v(" 域名解析-重要")]),s._v(" "),n("p",[s._v("http://doc.ewomail.com/docs/ewomail/domain_dns")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://imgoss.xgss.net/picgo/m_a8f7fce25341e4034b536b9554aab6d1_r.png?aliyun",alt:"img"}})]),s._v(" "),n("p",[s._v("遇到问题 @的txt记录跟cname记录冲突，所以删除cname记录")]),s._v(" "),n("p",[s._v("根据DNS解析协议标准，当TXT与CNAME同时存在会触发CNAME的排他性标准，导致DNS会解析错乱。因为TXT一般为验证性解析，如果您是需要利用TXT进行相关验证的话可以先做TXT解析记录，等到TXT解析记录验证成功了再进行CNAME添加。")]),s._v(" "),n("h1",{attrs:{id:"dkim设置-防垃圾邮件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#dkim设置-防垃圾邮件"}},[s._v("#")]),s._v(" DKIM设置（防垃圾邮件）")]),s._v(" "),n("p",[s._v("DKIM是电子邮件验证标准，域名密钥识别邮件标准，主要是用来防止被判定为垃圾邮件。")]),s._v(" "),n("p",[s._v("http://doc.ewomail.com/docs/ewomail/dkim")]),s._v(" "),n("p",[s._v("每个域名都需要添加一个dkim的key，EwoMail默认安装后已自动添加主域名dkim，只需要设置好dkim的dns即可。")]),s._v(" "),n("h2",{attrs:{id:"获取dkim-key"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#获取dkim-key"}},[s._v("#")]),s._v(" 获取dkim key")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('centos7/8\n# amavisd -c /etc/amavisd/amavisd.conf showkeys\n; key#1 1024 bits, i=dkim, d=your-domain.com, /ewomail/dkim/mail.pem\ndkim._domainkey.your-domain.com.     3600 TXT (\n  "v=DKIM1; p="\n  "XXXXXXX")\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[s._v("复制输出的信息，打开http://www.ewomail.com/list-20.html 整理dkim信息")]),s._v(" "),n("p",[s._v("整理完成后会在“整理显示区域”显示解析记录，接下来设置域名解析即可完成。")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("域名：your-domain.com\t\n记录类型： TXT\n主机记录：dkim._domainkey\n记录值：\nv=DKIM1;p=XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("h1",{attrs:{id:"自定义访问路径"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#自定义访问路径"}},[s._v("#")]),s._v(" 自定义访问路径")]),s._v(" "),n("p",[s._v("如果在apache修改了后台管理或webmail的访问路径，需要修改PHP配置文件才能正常使用webmail。")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("vi /ewomail/www/ewomail-admin/core/config.php\n\n<?php\n//配置文件\nreturn [\n    'dbhost' => 'localhost',//数据库连接地址\n    'dbuser' => 'ewomail',//数据库账号\n    'dbpw' => 'wIm9Hb9YiP3lMxVF',\n    'dbname' => 'ewomail',//数据库名称\n    'dbcharset' => 'utf8',//数据库编码\n    'dbprefix'=> 'i_',//数据库表的前缀\n    'code_key' => '22jCVkIiArtSEpYe',\n    'url' => 'http://mail.your-domain.com:8010',\n    'webmail_url' => 'http://mail.your-domain.com:8000',\n    'maildir'=>'/ewomail/mail',//邮件存放目录，邮件安装后请不要修改\n    'home_default' =>'Center',//默认项目\n    'home_allow' => ['Center','Api'],//允许项目\n    'module_default' =>'Index',//默认模块\n    'action_default' =>'index',//默认控制器\n    'prefix'=>'ewomail_',//网站通用前缀，包括session,cookie\n\n];\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br")])]),n("h1",{attrs:{id:"降低内存占用"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#降低内存占用"}},[s._v("#")]),s._v(" 降低内存占用")]),s._v(" "),n("p",[s._v("正式环境不用操作。")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("vim /etc/amavisd/amavisd.conf\n\n#在文件尾部加上该行参数\n@bypass_virus_checks_maps = (1);\n\n#最后按下esc键，输入:wq保存\n\n#修改文件（参考上面的例子操作命令修改）\nvim /usr/lib/systemd/system/amavisd.service\n在 Wants=clamd@amavisd.service 前面加上#符号\n#保存文件\n\nsystemctl daemon-reload\nsystemctl stop clamd@amavisd\nsystemctl disable clamd@amavisd\nsystemctl restart amavisd\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br")])]),n("h1",{attrs:{id:"网易邮箱大师客户端配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#网易邮箱大师客户端配置"}},[s._v("#")]),s._v(" 网易邮箱大师客户端配置")]),s._v(" "),n("p",[n("img",{attrs:{src:"http://imgoss.xgss.net/picgo/image-20210409160203025.png?aliyunoss",alt:"image-20210409160203025"}})]),s._v(" "),n("h1",{attrs:{id:"挂载nfs"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#挂载nfs"}},[s._v("#")]),s._v(" 挂载NFS")]),s._v(" "),n("p",[s._v("正式环境操作，考虑到附件可能会很大，如果单独购买云硬盘是不够的，购买NFS或者使用共享存储。这里生成环境购买nfs，挂载到 /ewomail。")]),s._v(" "),n("h2",{attrs:{id:"关闭服务"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#关闭服务"}},[s._v("#")]),s._v(" 关闭服务")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('service php-fpm stop\nservice nginx stop\nservice mysqld stop\nsystemctl stop postfix dovecot amavisd\n\nmv /ewomail /ewomail_bak\nmkdir /ewomail\n\nyum -y install nfs-utils\n\n执行以下命令，提高同时发起的NFS请求数量：\necho "options sunrpc tcp_slot_table_entries=128" >>  /etc/modprobe.d/sunrpc.conf\necho "options sunrpc tcp_max_slot_table_entries=128" >>  /etc/modprobe.d/sunrpc.conf\n\n# mkdir /aliyun_nfs\n# chown 777 -R /aliyun_nfs\n# mount -t nfs -o vers=3,nolock,proto=tcp,rsize=1048576,wsize=1048576,hard,timeo=600,retrans=2,noresvport xxxxxxxxxxxxxxx:/ /aliyun_nfs\n\n# mkdir -p /aliyun_nfs/ewomail/\n\n# mount -t nfs -o vers=3,nolock,proto=tcp,rsize=1048576,wsize=1048576,hard,timeo=600,retrans=2,noresvport xxxxxxxxxxxxxxx:/ewomail /ewomail\n\n# df -h |grep aliyun\n\n\nservice php-fpm start\nservice nginx start\nservice mysqld start\nsystemctl start postfix dovecot amavisd\n\n\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br")])]),n("h1",{attrs:{id:"数据库备份"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#数据库备份"}},[s._v("#")]),s._v(" 数据库备份")]),s._v(" "),n("p",[s._v("http://doc.ewomail.com/docs/ewomail/data_backup")]),s._v(" "),n("p",[s._v("EwoMail 主要目录在/ewomail，相关的数据与文件都存放在该目录。")]),s._v(" "),n("h2",{attrs:{id:"mysql备份"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#mysql备份"}},[s._v("#")]),s._v(" MYSQL备份")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("cat /ewomail/config.ini\n\n查看root密码，是否能登陆\n# mysql -u root -p'ybXkgm7T944sOlaD'\n# 导出数据库sql\n# mkdir /data/backup\n# mysqldump -u root  -P 3306 -p'ybXkgm7T944sOlaD' ewomail > /data/backup/ewomail.sql\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("h2",{attrs:{id:"文件打包备份"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#文件打包备份"}},[s._v("#")]),s._v(" 文件打包备份")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("# tar -zcf /data/backup/ewomail.tar.gz /ewomail/\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h1",{attrs:{id:"重装"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#重装"}},[s._v("#")]),s._v(" 重装")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("无法重装\n\n卸载：\nsystemctl stop nginx php-fpm mysqld postfix dovecot amavisd\nrm -rf /ewomail\nmv /usr/lib/systemd/system/mysqld.service  /usr/lib/systemd/system/mysqld.service_bak\nmv /etc/rc.d/init.d/mysqld /etc/rc.d/init.d/mysqld_bak\n\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])])])}),[],!1,null,null,null);a.default=t.exports}}]);