(window.webpackJsonp=window.webpackJsonp||[]).push([[203],{783:function(s,a,n){"use strict";n.r(a);var e=n(17),t=Object(e.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"使用xtrabackup备份和恢复mysql数据库"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#使用xtrabackup备份和恢复mysql数据库"}},[s._v("#")]),s._v(" 使用xtrabackup备份和恢复mysql数据库")]),s._v(" "),n("h2",{attrs:{id:"mysqldump"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#mysqldump"}},[s._v("#")]),s._v(" mysqldump")]),s._v(" "),n("p",[s._v("一种逻辑备份方式，将数据转换成sql文件，其最大的缺陷就是备份和恢复时间很长，对于一个小于10G的数据库而言，这个速度还是可以接受的，但是如果数据库较大，那在使用mysqldump备份就非常不合适了。")]),s._v(" "),n("h2",{attrs:{id:"lvm"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#lvm"}},[s._v("#")]),s._v(" lvm")]),s._v(" "),n("p",[s._v("是一种采用逻辑卷快照功能对数据进行备份，可以实现几乎热备，但是备份过程较为复杂(来回切换终端)，很难用shell脚本直接实现，不过现在似乎有个工具mylvmbackup可以实现自动化备份，但是没有尝试过。")]),s._v(" "),n("h2",{attrs:{id:"xtrabackup"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#xtrabackup"}},[s._v("#")]),s._v(" Xtrabackup")]),s._v(" "),n("p",[s._v("对MyISAM表只能实现温备，并且不支持增量备份，所以每次对MyISAM表备份都是全备。")]),s._v(" "),n("p",[s._v("XtraBackup更多高级特性通常只能在innodb存储引擎上实现，而且高级特性还都依赖于mysql数据库对innodb引擎实现了单独表空间，否则没办法实现单表或单库导出")]),s._v(" "),n("p",[s._v("那么今天就和大家聊聊第三款开源备份工具xtrabackup：")]),s._v(" "),n("p",[s._v("官方站点：http://www.percona.com")]),s._v(" "),n("p",[s._v("官方在线文档：http://www.percona.com/doc/percona-xtrabackup/2.2/")]),s._v(" "),n("p",[s._v("最新软件包下载地址：http://www.percona.com/downloads/XtraBackup/")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("mysql> show global variables like '%innodb_file_per_table%';\n\n+-----------------------+-------+\n| Variable_name         | Value |\n+-----------------------+-------+\n| innodb_file_per_table | ON    |\n+-----------------------+-------+\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("h2",{attrs:{id:"系统说明"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#系统说明"}},[s._v("#")]),s._v(" 系统说明")]),s._v(" "),n("p",[s._v("系统：CentOS release 6.7\n数据库： 10.0.25-MariaDB\n数据库目录： /var/lib/mysql --软连接--\x3e /data/mysql\n备份目录：/backup/")]),s._v(" "),n("h1",{attrs:{id:"二、安装"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#二、安装"}},[s._v("#")]),s._v(" 二、安装")]),s._v(" "),n("p",[s._v("XtraBackup本篇文章采用yum安装方式")]),s._v(" "),n("h2",{attrs:{id:"_1、yum安装"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1、yum安装"}},[s._v("#")]),s._v(" 1、yum安装")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("# wget http://www.percona.com/downloads/XtraBackup/XtraBackup-2.2.9/binary/redhat/6/x86_64/percona-xtrabackup-2.2.9-5067.el6.x86_64.rpm\n# rpm -ivh percona-xtrabackup-2.2.9-5067.el6.x86_64.rpm\nwarning: percona-xtrabackup-2.2.9-5067.el6.x86_64.rpm: Header V4 DSA/SHA1 Signature, key ID cd2efd2a: NOKEY\nerror: Failed dependencies:\n        perl(DBD::mysql) is needed by percona-xtrabackup-2.2.9-5067.el6.x86_64\n        perl(Time::HiRes) is needed by percona-xtrabackup-2.2.9-5067.el6.x86_64\n# yum -y install perl-Time-HiRes perl-DBD-MySQL perl-IO-Socket-SSL\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("h2",{attrs:{id:"_2、查看xtrabackup安装的工具"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2、查看xtrabackup安装的工具"}},[s._v("#")]),s._v(" 2、查看Xtrabackup安装的工具")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("# rpm -ql percona-xtrabackup |grep bin\n/usr/bin/innobackupex\n/usr/bin/xbcrypt\n/usr/bin/xbstream\n/usr/bin/xtrabackup\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("h2",{attrs:{id:"_3、xtrabackup中主要包含了三个工具"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3、xtrabackup中主要包含了三个工具"}},[s._v("#")]),s._v(" 3、XtraBackup中主要包含了三个工具")]),s._v(" "),n("p",[s._v("xbsteam 支持流式备份\nxtrbackup 用于热备innodb、xtradb表中数据的工具，不能备份其它类型的表，也不能备份数据表结构\ninnobackupex 是将xtrabackup进行封装的perl脚本，提供了备份MyISAM表的能力")]),s._v(" "),n("h1",{attrs:{id:"三、innobackupex几个非常重要的参数"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#三、innobackupex几个非常重要的参数"}},[s._v("#")]),s._v(" 三、innobackupex几个非常重要的参数")]),s._v(" "),n("p",[s._v("--apply-log\n一般情况下，在备份完成后，数据尚且不能用于恢复操作，因为备份的数据中可能会包含尚未提交的事务或已经提交但尚未同步至数据文件中的事务。因此，此时数据文件仍处理不一致状态。“准备”的主要作用正是通过回滚未提交的事务及同步已经提交的事务至数据文件也使得数据文件处于一致性状态。")]),s._v(" "),n("p",[s._v("--redo-only\n准备(prepare)增量备份与整理完全备份有着一些不同，尤其要注意的是：\n(1)需要在每个备份(包括完全和各个增量备份)上，将已经提交的事务进行“重放”。“重放”之后，所有的备份数据将合并到完全备份上。\n(2)基于所有的备份将未提交的事务进行“回滚”。")]),s._v(" "),n("p",[s._v("--copy-back\n该选项用于执行恢复(还原)操作，其通过复制所有数据相关的文件至mysql服务器DATADIR目录中来执行恢复过程。innobackupex通过backup-my.cnf来获取DATADIR目录的相关信息。")]),s._v(" "),n("h1",{attrs:{id:"四、innobackup备份语法"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#四、innobackup备份语法"}},[s._v("#")]),s._v(" 四、innobackup备份语法")]),s._v(" "),n("h2",{attrs:{id:"_1-完全备份-完全恢复"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-完全备份-完全恢复"}},[s._v("#")]),s._v(" 1.完全备份+完全恢复")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("完全备份\n# innobackupex --user=DBUSER --password=DBUSERPASS  /path/to/BACKUP-DIR/\ninnobackupex --user=root --password=123456  /backup\n准备一个完全备份\ninnobackupex --apply-log  /path/to/BACKUP-DIR\n\n从一个完全备份中恢复数据\n# innobackupex --copy-back /path/to/BACKUP-DIR\ninnobackupex --copy-back /backup\n\n修改datadir目录权限\n# chown -R  mysql:mysql  /mydata/data/\n\ninnobackupex --defaults-file=/etc/my.cnf --user=root  --copy-back /backup/2016-07-07_14-32-33/\n恢复操作出现错误\ninnobackupex: Error: no 'datadir' option in group 'mysqld' in server configuration file '/etc/my.cnf' at /usr/bin/innobackupex line 4506.\n解决办法：\nvi /etc/my.cnf 在[mysqld]选项下面添加：\ndatadir                = /data/mysql\n出现错误：\ninnobackupex: Error: Original data directory '/data/mysql' is not empty! at /usr/bin/innobackupex line 2194.\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br")])]),n("h2",{attrs:{id:"_2-完全备份-增量备份-完全恢复"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-完全备份-增量备份-完全恢复"}},[s._v("#")]),s._v(" 2.完全备份+增量备份+完全恢复")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("完全备份：\n# innobackupex --user=DBUSER --password=DBUSERPASS  /path/to/BACKUP-DIR/\n\n第一次增量备份\n# innobackupex --user=DBUSER --password=DBUSERPASS --incremental /backup --incremental-basedir=BASEDIR\n\n第二次增量备份\n# innobackupex --user=DBUSER --password=DBUSERPASS --incremental /backup --incremental-basedir=BASEDIR\n\n准备：\n执行完全备份redo\n\n# innobackupex --apply-log --redo-only BASE-DIR\n执行第一次增量备份redo\n\n# innobackupex --apply-log --redo-only BASE-DIR --incremental-dir=INCREMENTAL-DIR-1\n\n执行第二次增量备份redo\n\n# innobackupex --apply-log --redo-only BASE-DIR --incremental-dir=INCREMENTAL-DIR-2\n\n还原：\n\n# innobackupex --copy-back BASE-DIR\n\n解释：\n其中BASE-DIR指的是完全备份所在的目录，\n而INCREMENTAL-DIR-1指的是第一次增量备份的目录，\nINCREMENTAL-DIR-2指的是第二次增量备份的目录，\n其它依次类推，即如果有多次增量备份，每一次都要执行如上操作；\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br")])]),n("h1",{attrs:{id:"五、以上两种方式案列重放"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#五、以上两种方式案列重放"}},[s._v("#")]),s._v(" 五、以上两种方式案列重放")]),s._v(" "),n("h2",{attrs:{id:"_1-完全备份-完全恢复-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-完全备份-完全恢复-2"}},[s._v("#")]),s._v(" 1.完全备份+完全恢复")]),s._v(" "),n("h3",{attrs:{id:"_1、实验前的准备工作"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1、实验前的准备工作"}},[s._v("#")]),s._v(" 1、实验前的准备工作")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("# service mysqld stop\n# rm -rf /mydata/data/*\t\n# /usr/local/mysql/scripts/mysql_install_db --user=mysql --datadir=/mydata/data/ --basedir=/usr/local/mysql/\n# service mysqld start\n# mysqladmin -uroot -p password 123456\n# mysql -uroot -p123456\nmysql> create database jiaowu;\nmysql> use jiaowu;\nmysql> set sql_log_bin = 0;\nmysql> source /root/tutor.sql;    //导入tutor数据表\nmysql> set sql_log_bin = 1;\nmysql> select * from tutor;\n+------+---------------+--------+------+\n| TID  | Tname         | Gender | Age  |\n+------+---------------+--------+------+\n|    1 | ZhengYansheng | M      |   25 |\n|    2 | LiJian        | M      |   26 |\n|    3 | OuYangyu      | M      |   27 |\n|    4 | LuoChenghui   | M      |   25 |\n|    5 | LiuYunbo      | M      |   25 |\n|    6 | FuJian        | M      |   24 |\n|    7 | LiMenglu      | F      |   23 |\n|    8 | BaoYintu      | M      |   28 |\n|    9 | WangYana      | F      |   25 |\n+------+---------------+--------+------+\n9 rows in set (0.00 sec)\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br")])]),n("h3",{attrs:{id:"_2、innobackupex对db进行完全备份"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2、innobackupex对db进行完全备份"}},[s._v("#")]),s._v(" 2、innobackupex对DB进行完全备份")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("# innobackupex --user=root --password=123456 /backup/\n\n如果执行正确，其最后输出的几行信息通常如下：\ninnobackupex: Backup created in directory '/backup/2015-03-18_21-00-17'\ninnobackupex: MySQL binlog position: filename 'mysql-bin.000003', position 332\n150318 21:00:23  innobackupex: Connection to database server closed\n150318 21:00:23  innobackupex: completed OK!\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("h3",{attrs:{id:"_3、查看备份目录和文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3、查看备份目录和文件"}},[s._v("#")]),s._v(" 3、查看备份目录和文件")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("# ls /backup/\n2015-03-18_21-00-17\n# ls /backup/2015-03-18_21-00-17/\nbackup-my.cnf  jiaowu  performance_schema  xtrabackup_binlog_info  xtrabackup_info\nibdata1        mysql   test                xtrabackup_checkpoints  xtrabackup_logfile\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("h3",{attrs:{id:"_4、准备一个完全备份"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4、准备一个完全备份"}},[s._v("#")]),s._v(" 4、准备一个完全备份")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("# innobackupex --user=root --password=123456 --apply-log /backup/2015-03-18_21-00-17/\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h3",{attrs:{id:"_5、这里还是采用老方法直接删除所有的数据文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5、这里还是采用老方法直接删除所有的数据文件"}},[s._v("#")]),s._v(" 5、这里还是采用老方法直接删除所有的数据文件")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("# service mysqld stop\n# rm -rf /mydata/data/*\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h3",{attrs:{id:"_6、从一个完全备份中恢复数据库"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6、从一个完全备份中恢复数据库"}},[s._v("#")]),s._v(" 6、从一个完全备份中恢复数据库")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("innobackupex --copy-back /backup/2015-03-18_21-00-17/\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h3",{attrs:{id:"_7、修改数据目录权限"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_7、修改数据目录权限"}},[s._v("#")]),s._v(" 7、修改数据目录权限")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("# chown -R mysql.mysql /mydata/data/\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h3",{attrs:{id:"_8、启动mysqld服务"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_8、启动mysqld服务"}},[s._v("#")]),s._v(" 8、启动mysqld服务")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("service mysqld start\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h3",{attrs:{id:"_9、登陆mysql查看是否是否一致"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_9、登陆mysql查看是否是否一致"}},[s._v("#")]),s._v(" 9、登陆mysql查看是否是否一致")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("# mysql -e 'use jiaowu;select * from tutor;'\n+------+---------------+--------+------+\n| TID  | Tname         | Gender | Age  |\n+------+---------------+--------+------+\n|    1 | ZhengYansheng | M      |   25 |\n|    2 | LiJian        | M      |   26 |\n|    3 | OuYangyu      | M      |   27 |\n|    4 | LuoChenghui   | M      |   25 |\n|    5 | LiuYunbo      | M      |   25 |\n|    6 | FuJian        | M      |   24 |\n|    7 | LiMenglu      | F      |   23 |\n|    8 | BaoYintu      | M      |   28 |\n|    9 | WangYana      | F      |   25 |\n+------+---------------+--------+------+\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br")])]),n("p",[s._v("数据已经成功恢复到数据库当中")]),s._v(" "),n("h2",{attrs:{id:"_2-完全备份-增量备份-完全恢复-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-完全备份-增量备份-完全恢复-2"}},[s._v("#")]),s._v(" 2.完全备份+增量备份+完全恢复")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("1、实验前的准备工作\n# service mysqld stop\n# rm -rf /mydata/data/*     //删除原来的备份文件\n# rm -rf /backup/*\n# /usr/local/mysql/scripts/mysql_install_db --user=mysql --datadir=/mydata/data/ --basedir=/usr/local/mysql/\n# service mysqld start\n# mysqladmin -uroot -p password 123456\n# mysql -uroot -p123456\nmysql> create database jiaowu;\nmysql> use jiaowu;\nmysql> set sql_log_bin = 0;\nmysql> source /root/tutor.sql;   //导入tutor数据表\nmysql> set sql_log_bin = 1;\nmysql> select * from tutor;\n+------+---------------+--------+------+\n| TID  | Tname         | Gender | Age  |\n+------+---------------+--------+------+\n|    1 | ZhengYansheng | M      |   25 |\n|    2 | LiJian        | M      |   26 |\n|    3 | OuYangyu      | M      |   27 |\n|    4 | LuoChenghui   | M      |   25 |\n|    5 | LiuYunbo      | M      |   25 |\n|    6 | FuJian        | M      |   24 |\n|    7 | LiMenglu      | F      |   23 |\n|    8 | BaoYintu      | M      |   28 |\n|    9 | WangYana      | F      |   25 |\n+------+---------------+--------+------+\n9 rows in set (0.00 sec)\n\n2、innobackupex对DB进行完全备份\n# innobackupex --user=root --password=123456 /backup/\n如果执行正确，其最后输出的几行信息通常如下：\ninnobackupex: Backup created in directory '/backup/2015-03-18_21-14-49'\ninnobackupex: MySQL binlog position: filename 'mysql-bin.000003', position 332\n150318 21:14:54  innobackupex: Connection to database server closed\n150318 21:14:54  innobackupex: completed OK!\n\n3、仅查看备份目录\n# ls /backup/\n2015-03-18_21-14-49\n\n4、操作数据库并插入数据\n# mysql jiaowu;\nmysql> insert into tutor(TID) values(11);\nmysql> insert into tutor(TID) values(12);\nmysql> insert into tutor(TID) values(13);\nmysql> select * from tutor;\n+------+---------------+--------+------+\n| TID  | Tname         | Gender | Age  |\n+------+---------------+--------+------+\n|    1 | ZhengYansheng | M      |   25 |\n|    2 | LiJian        | M      |   26 |\n|    3 | OuYangyu      | M      |   27 |\n|    4 | LuoChenghui   | M      |   25 |\n|    5 | LiuYunbo      | M      |   25 |\n|    6 | FuJian        | M      |   24 |\n|    7 | LiMenglu      | F      |   23 |\n|    8 | BaoYintu      | M      |   28 |\n|    9 | WangYana      | F      |   25 |\n|   11 | NULL          | NULL   | NULL |\n|   12 | NULL          | NULL   | NULL |\n|   13 | NULL          | NULL   | NULL |\n+------+---------------+--------+------+\n12 rows in set (0.00 sec)\n\n5、执行第一次增量备份并查看备份目录\n# innobackupex --user=root --password=123456 --incremental /backup/ --incremental-basedir=/backup/2015-03-18_21-14-49/\n# ls /backup/\n2015-03-18_21-14-49  2015-03-18_21-18-45\n\n6、再次操作数据库并插入多条数据\n# mysql jiaowu;\nmysql> insert into tutor(TID) values(21);\nmysql> insert into tutor(TID) values(22);\nmysql> insert into tutor(TID) values(23);\nmysql> select * from tutor;\n+------+---------------+--------+------+\n| TID  | Tname         | Gender | Age  |\n+------+---------------+--------+------+\n|    1 | ZhengYansheng | M      |   25 |\n|    2 | LiJian        | M      |   26 |\n|    3 | OuYangyu      | M      |   27 |\n|    4 | LuoChenghui   | M      |   25 |\n|    5 | LiuYunbo      | M      |   25 |\n|    6 | FuJian        | M      |   24 |\n|    7 | LiMenglu      | F      |   23 |\n|    8 | BaoYintu      | M      |   28 |\n|    9 | WangYana      | F      |   25 |\n|   11 | NULL          | NULL   | NULL |\n|   12 | NULL          | NULL   | NULL |\n|   13 | NULL          | NULL   | NULL |\n|   21 | NULL          | NULL   | NULL |\n|   22 | NULL          | NULL   | NULL |\n|   23 | NULL          | NULL   | NULL |\n+------+---------------+--------+------+\n15 rows in set (0.00 sec)\n\n7、执行第二次增量备份并查看备份文件\n# innobackupex --user=root --password=123456 --incremental /backup/ --incremental-basedir=/backup/2015-03-18_21-18-45/\n# ls /backup/\n2015-03-18_21-14-49  2015-03-18_21-18-45  2015-03-18_21-22-31\n\n解释：\n2015-03-18_21-14-49：为innobackupex的完全备份目录\n2015-03-18_21-18-45：为innobackupex的第一次增量备份目录\n2015-03-18_21-22-31：为innobackupex的第二次增量备份目录\n\n8、开始准备innobackupex\n首先执行完全备份redo-only\n# innobackupex --user=root --password=123456 --apply-log --redo-only /backup/2015-03-18_21-14-49/\n执行第一个增量备份redo-only\n# innobackupex --user=root --password=123456 --apply-log --redo-only /backup/2015-03-18_21-14-49/ --incremental-dir=/backup/2015-03-18_21-18-45/\n执行第二个增量备份redo-only\n# innobackupex --user=root --password=123456 --apply-log --redo-only /backup/2015-03-18_21-14-49/ --incremental-dir=/backup/2015-03-18_21-22-31/\n\n#####模拟数据库故障#####\n9、这里还是采用老方法直接删除所有的数据文件\n# service mysqld stop\n# rm -rf /mydata/data/*\n\n10、从完全备份中恢复数据库\n# innobackupex --user=root --password=123456 --copy-back /backup/2015-03-18_21-14-49/\n\n11、修改数据目录权限\n# chown -R mysql.mysql /mydata/data/\n \n12、启动mysqld服务\n# service mysqld start\n \n13、登陆mysql查看是否是否一致\n# mysql -e 'use jiaowu;select * from tutor;'\n+------+---------------+--------+------+\n| TID  | Tname         | Gender | Age  |\n+------+---------------+--------+------+\n|    1 | ZhengYansheng | M      |   25 |\n|    2 | LiJian        | M      |   26 |\n|    3 | OuYangyu      | M      |   27 |\n|    4 | LuoChenghui   | M      |   25 |\n|    5 | LiuYunbo      | M      |   25 |\n|    6 | FuJian        | M      |   24 |\n|    7 | LiMenglu      | F      |   23 |\n|    8 | BaoYintu      | M      |   28 |\n|    9 | WangYana      | F      |   25 |\n|   11 | NULL          | NULL   | NULL |\n|   12 | NULL          | NULL   | NULL |\n|   13 | NULL          | NULL   | NULL |\n|   21 | NULL          | NULL   | NULL |\n|   22 | NULL          | NULL   | NULL |\n|   23 | NULL          | NULL   | NULL |\n+------+---------------+--------+------+\n\n#两次增量添加的数据也已经成功添加到数据库当中。恢复成功\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br"),n("span",{staticClass:"line-number"},[s._v("82")]),n("br"),n("span",{staticClass:"line-number"},[s._v("83")]),n("br"),n("span",{staticClass:"line-number"},[s._v("84")]),n("br"),n("span",{staticClass:"line-number"},[s._v("85")]),n("br"),n("span",{staticClass:"line-number"},[s._v("86")]),n("br"),n("span",{staticClass:"line-number"},[s._v("87")]),n("br"),n("span",{staticClass:"line-number"},[s._v("88")]),n("br"),n("span",{staticClass:"line-number"},[s._v("89")]),n("br"),n("span",{staticClass:"line-number"},[s._v("90")]),n("br"),n("span",{staticClass:"line-number"},[s._v("91")]),n("br"),n("span",{staticClass:"line-number"},[s._v("92")]),n("br"),n("span",{staticClass:"line-number"},[s._v("93")]),n("br"),n("span",{staticClass:"line-number"},[s._v("94")]),n("br"),n("span",{staticClass:"line-number"},[s._v("95")]),n("br"),n("span",{staticClass:"line-number"},[s._v("96")]),n("br"),n("span",{staticClass:"line-number"},[s._v("97")]),n("br"),n("span",{staticClass:"line-number"},[s._v("98")]),n("br"),n("span",{staticClass:"line-number"},[s._v("99")]),n("br"),n("span",{staticClass:"line-number"},[s._v("100")]),n("br"),n("span",{staticClass:"line-number"},[s._v("101")]),n("br"),n("span",{staticClass:"line-number"},[s._v("102")]),n("br"),n("span",{staticClass:"line-number"},[s._v("103")]),n("br"),n("span",{staticClass:"line-number"},[s._v("104")]),n("br"),n("span",{staticClass:"line-number"},[s._v("105")]),n("br"),n("span",{staticClass:"line-number"},[s._v("106")]),n("br"),n("span",{staticClass:"line-number"},[s._v("107")]),n("br"),n("span",{staticClass:"line-number"},[s._v("108")]),n("br"),n("span",{staticClass:"line-number"},[s._v("109")]),n("br"),n("span",{staticClass:"line-number"},[s._v("110")]),n("br"),n("span",{staticClass:"line-number"},[s._v("111")]),n("br"),n("span",{staticClass:"line-number"},[s._v("112")]),n("br"),n("span",{staticClass:"line-number"},[s._v("113")]),n("br"),n("span",{staticClass:"line-number"},[s._v("114")]),n("br"),n("span",{staticClass:"line-number"},[s._v("115")]),n("br"),n("span",{staticClass:"line-number"},[s._v("116")]),n("br"),n("span",{staticClass:"line-number"},[s._v("117")]),n("br"),n("span",{staticClass:"line-number"},[s._v("118")]),n("br"),n("span",{staticClass:"line-number"},[s._v("119")]),n("br"),n("span",{staticClass:"line-number"},[s._v("120")]),n("br"),n("span",{staticClass:"line-number"},[s._v("121")]),n("br"),n("span",{staticClass:"line-number"},[s._v("122")]),n("br"),n("span",{staticClass:"line-number"},[s._v("123")]),n("br"),n("span",{staticClass:"line-number"},[s._v("124")]),n("br"),n("span",{staticClass:"line-number"},[s._v("125")]),n("br"),n("span",{staticClass:"line-number"},[s._v("126")]),n("br"),n("span",{staticClass:"line-number"},[s._v("127")]),n("br"),n("span",{staticClass:"line-number"},[s._v("128")]),n("br"),n("span",{staticClass:"line-number"},[s._v("129")]),n("br"),n("span",{staticClass:"line-number"},[s._v("130")]),n("br"),n("span",{staticClass:"line-number"},[s._v("131")]),n("br"),n("span",{staticClass:"line-number"},[s._v("132")]),n("br"),n("span",{staticClass:"line-number"},[s._v("133")]),n("br"),n("span",{staticClass:"line-number"},[s._v("134")]),n("br"),n("span",{staticClass:"line-number"},[s._v("135")]),n("br"),n("span",{staticClass:"line-number"},[s._v("136")]),n("br"),n("span",{staticClass:"line-number"},[s._v("137")]),n("br"),n("span",{staticClass:"line-number"},[s._v("138")]),n("br"),n("span",{staticClass:"line-number"},[s._v("139")]),n("br"),n("span",{staticClass:"line-number"},[s._v("140")]),n("br"),n("span",{staticClass:"line-number"},[s._v("141")]),n("br"),n("span",{staticClass:"line-number"},[s._v("142")]),n("br"),n("span",{staticClass:"line-number"},[s._v("143")]),n("br"),n("span",{staticClass:"line-number"},[s._v("144")]),n("br"),n("span",{staticClass:"line-number"},[s._v("145")]),n("br"),n("span",{staticClass:"line-number"},[s._v("146")]),n("br"),n("span",{staticClass:"line-number"},[s._v("147")]),n("br"),n("span",{staticClass:"line-number"},[s._v("148")]),n("br"),n("span",{staticClass:"line-number"},[s._v("149")]),n("br"),n("span",{staticClass:"line-number"},[s._v("150")]),n("br"),n("span",{staticClass:"line-number"},[s._v("151")]),n("br"),n("span",{staticClass:"line-number"},[s._v("152")]),n("br")])]),n("h1",{attrs:{id:"六、xtrabackup的高级功能"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#六、xtrabackup的高级功能"}},[s._v("#")]),s._v(" 六、Xtrabackup的高级功能")]),s._v(" "),n("h2",{attrs:{id:"流式压缩功能"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#流式压缩功能"}},[s._v("#")]),s._v(" 流式压缩功能")]),s._v(" "),n("p",[s._v("Xtrabackup对备份的数据文件支持“流”功能，即可以将备份的数据通过STDOUT传输给tar程序进行归档，而不是默认的直接保存至某备份目录中。要使用此功能，仅需要使用--stream选项即可。如：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("# innobackupex --user=root --password=123456 --stream=tar  /backup | gzip > /backup/`date +%F_%H-%M-%S`.tar.gz\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("甚至也可以使用类似如下命令将数据备份至其它服务器：强烈推荐这种方式")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("innobackupex --user=root --password=123456 --stream=tar  /backup | ssh root@192.168.1.100  'cat - > /backup/`date +%F_%H-%M-%S`.tar'\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("在执行本地备份时，还可以使用--parallel选项对多个文件进行并行复制（暂时还没有看懂此选项）")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("此外，在执行本地备份时，还可以使用--parallel选项对多个文件进行并行复制。此选项用于指定在复制时启动的线程数目。当然，在实际进行备份时要利用此功能的便利性，也需要启用innodb_file_per_table选项或共享的表空间通过innodb_data_file_path选项存储在多个ibdata文件中。对某一数据库的多个文件的复制无法利用到此功能。其简单使用方法如下：\n\n# innobackupex --parallel  /path/to/backup\n\n同时，innobackupex备份的数据文件也可以存储至远程主机，这可以使用--remote-host选项来实现：\n\n# innobackupex --remote-host=root@www.magedu.com  /path/IN/REMOTE/HOST/to/backup\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("h1",{attrs:{id:"七、使用xtrabackup对数据库进行部分备份"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#七、使用xtrabackup对数据库进行部分备份"}},[s._v("#")]),s._v(" 七、使用Xtrabackup对数据库进行部分备份")]),s._v(" "),n("p",[s._v("Xtrabackup也可以实现部分备份，即只备份某个或某些指定的数据库或某数据库中的某个或某些表。但要使用此功能，必须启用innodb_file_per_table选项，即每张表保存为一个独立的文件。同时，其也不支持--stream选项，即不支持将数据通过管道传输给其它程序进行处理。")]),s._v(" "),n("p",[s._v("此外，还原部分备份跟还原全部数据的备份也有所不同，即你不能通过简单地将prepared的部分备份使用--copy-back选项直接复制回数据目录，而是要通过导入表的方向来实现还原。当然，有些情况下，部分备份也可以直接通过--copy-back进行还原，但这种方式还原而来的数据多数会产生数据不一致的问题，因此，无论如何不推荐使用这种方式。")]),s._v(" "),n("h3",{attrs:{id:"_1-创建部分备份"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-创建部分备份"}},[s._v("#")]),s._v(" 1)创建部分备份")]),s._v(" "),n("p",[s._v("创建部分备份的方式有三种：")]),s._v(" "),n("p",[s._v("正则表达式(--include)")]),s._v(" "),n("p",[s._v("枚举表文件(--tables-file)")]),s._v(" "),n("p",[s._v("列出要备份的数据库(--databases)。")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("(a)使用--include\n使用--include时，要求为其指定要备份的表的完整名称，即形如databasename.tablename，如：\n# innobackupex --include='^mageedu[.]tb1'  /path/to/backup\n\n(b)使用--tables-file\n此选项的参数需要是一个文件名，此文件中每行包含一个要备份的表的完整名称；如：\n# echo -e 'mageedu.tb1\\nmageedu.tb2' > /tmp/tables.txt\n# innobackupex --tables-file=/tmp/tables.txt  /path/to/backup\n\n(c)使用--databases\n此选项接受的参数为数据名，如果要指定多个数据库，彼此间需要以空格隔开；同时，在指定某数据库时，也可以只指定其中的某张表。此外，此选项也可以接受一个文件为参数，文件中每一行为一个要备份的对象。如：\n# innobackupex --databases=\"mageedu testdb\"  /path/to/backup\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("h3",{attrs:{id:"_2-整理-preparing-部分备份"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-整理-preparing-部分备份"}},[s._v("#")]),s._v(" 2)整理(preparing)部分备份")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("prepare部分备份的过程类似于导出表的过程，要使用--export选项进行：\n# innobackupex --apply-log --export  /pat/to/partial/backup\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[s._v("此命令执行过程中，innobackupex会调用xtrabackup命令从数据字典中移除缺失的表，因此，会显示出许多关于“表不存在”类的警告信息。同时，也会显示出为备份文件中存在的表创建.exp文件的相关信息。")]),s._v(" "),n("h3",{attrs:{id:"_3-还原部分备份"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-还原部分备份"}},[s._v("#")]),s._v(" 3)还原部分备份")]),s._v(" "),n("p",[s._v("还原部分备份的过程跟导入表的过程相同。当然，也可以通过直接复制prepared状态的备份直接至数据目录中实现还原，不要此时要求数据目录处于一致状态。")]),s._v(" "),n("p",[s._v("案列演示：")]),s._v(" "),n("p",[s._v("对jiaowu数据库进行备份和还原")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("1、查看数据库和表\nmysql> show databases;\n+--------------------+\n| Database           |\n+--------------------+\n| information_schema |\n| jiaowu             |\n| mysql              |\n| performance_schema |\n| test               |\n+--------------------+\n5 rows in set (0.00 sec)\nmysql> select * from jiaowu.tutor;\n+------+---------------+--------+------+\n| TID  | Tname         | Gender | Age  |\n+------+---------------+--------+------+\n|    1 | ZhengYansheng | M      |   25 |\n|    2 | LiJian        | M      |   26 |\n|    3 | OuYangyu      | M      |   27 |\n|    4 | LuoChenghui   | M      |   25 |\n|    5 | LiuYunbo      | M      |   25 |\n|    6 | FuJian        | M      |   24 |\n|    7 | LiMenglu      | F      |   23 |\n|    8 | BaoYintu      | M      |   28 |\n|    9 | WangYana      | F      |   25 |\n|   11 | NULL          | NULL   | NULL |\n|   12 | NULL          | NULL   | NULL |\n|   13 | NULL          | NULL   | NULL |\n|   21 | NULL          | NULL   | NULL |\n|   22 | NULL          | NULL   | NULL |\n|   23 | NULL          | NULL   | NULL |\n+------+---------------+--------+------+\n\n2、innobackupex进行备份\n# innobackupex --user=root --password=123456 --databases='jiaowu' /opt/\n\n3、准备并导入jiaowu表\n# innobackupex --user=root --password=123456 --apply-log --export /opt/2015-03-18_22-46-47/\n\n4、删除jiaowu数据库\n# rm -rf /mydata/data/jiaowu\n\n5、登陆数据库查看是否还存在jiaowu数据库\n[root@localhost ~]# mysql -e 'show databases;'\n+--------------------+\n| Database           |\n+--------------------+\n| information_schema |\n| mysql              |\n| performance_schema |\n| test               |\n+--------------------+\n#jiaowu数据库不存在了\n\n6、还原jiaowu数据库\n# cp -a /opt/2015-03-18_22-46-47/jiaowu/ /mydata/data/\n\n7、修改jiaowu权限\n# chown -R mysql.mysql /mydata/data/jiaowu\n\n8、再次查看jiaowu数据库是否存在\n[root@localhost ~]# mysql -e 'use jiaowu;show tables;'\n+------------------+\n| Tables_in_jiaowu |\n+------------------+\n| tutor            |\n+------------------+\n\n#jiaowu数据库已经被还原并且表tutor还在。成功！！！\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br")])]),n("h1",{attrs:{id:"八、导入或导出单张表"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#八、导入或导出单张表"}},[s._v("#")]),s._v(" 八、导入或导出单张表")]),s._v(" "),n("p",[s._v("默认情况下，InnoDB表不能通过直接复制表文件的方式在mysql服务器之间进行移植，即便使用了innodb_file_per_table选项。而使用Xtrabackup工具可以实现此种功能，")]),s._v(" "),n("p",[s._v("不过，此时需要“导出”表的mysql服务器启用了innodb_file_per_table选项（严格来说，是要“导出”的表在其创建之前，mysql服务器就启用了innodb_file_per_table选项），")]),s._v(" "),n("p",[s._v("并且“导入”表的服务器同时启用了innodb_file_per_table和innodb_expand_import选项。")]),s._v(" "),n("h3",{attrs:{id:"_1-导出-表"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-导出-表"}},[s._v("#")]),s._v(" 1)“导出”表")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("导出表是在备份的prepare阶段进行的，因此，一旦完全备份完成，就可以在prepare过程中通过--export选项将某表导出了：\n# innobackupex --apply-log --export /path/to/backup\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[s._v("此命令会为每个innodb表的表空间创建一个以.exp结尾的文件，这些以.exp结尾的文件则可以用于导入至其它服务器。")]),s._v(" "),n("h3",{attrs:{id:"_2-导入-表"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-导入-表"}},[s._v("#")]),s._v(" 2)“导入”表")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("要在mysql服务器上导入来自于其它服务器的某innodb表，需要先在当前服务器上创建一个跟原表表结构一致的表，而后才能实现将表导入：\nmysql> CREATE TABLE mytable (...)  ENGINE=InnoDB;\n\n然后将此表的表空间删除：\nmysql> ALTER TABLE mydatabase.mytable  DISCARD TABLESPACE;\n\n接下来，将来自于“导出”表的服务器的mytable表的mytable.ibd和mytable.exp文件复制到当前服务器的数据目录，然后使用如下命令将其“导入”：\nmysql> ALTER TABLE mydatabase.mytable  IMPORT TABLESPACE;\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("p",[s._v("案列演示：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("1、查看表\nmysql> use jiaowu;\nDatabase changed\nmysql> show tables;\n+------------------+\n| Tables_in_jiaowu |\n+------------------+\n| tutor            |\n+------------------+\n1 row in set (0.00 sec)\n\n2、修改表的存储引擎为InnoDB\nmysql> alter table tutor engine=innodb;\nQuery OK, 15 rows affected (0.05 sec)\nRecords: 15  Duplicates: 0  Warnings: 0\n\n3、innobackupex对其进行备份\n# innobackupex --user=root --password=123456 --databases='jiaowu.tutor' /opt/\n\n4、准备并导出\n# innobackupex --user=root --password=123456 --apply-log --export /opt/2015-03-18_23-05-44/\n\n5、删除此表的表空间\nmysql> ALTER TABLE jiaowu.tutor DISCARD TABLESPACE;\nQuery OK, 0 rows affected (0.01 sec)\n\nmysql> use jiaowu;\nDatabase changed\nmysql> select * from tutor;        #数据已经不存在了\nERROR 1030 (HY000): Got error -1 from storage engine\n\n6、接下来，将来自于“导出”表的服务器的mytable表的mytable.ibd和mytable.exp文件复制到当前服务器的数据目录，然后使用如下命令将其“导入”：并修改权限\n# cp /opt/2015-03-18_23-24-23/jiaowu/{tutor.exp,tutor.ibd} /mydata/data/jiaowu/\ncp：是否覆盖\"/mydata/data/jiaowu/tutor.exp\"？ yes\n# chown -R mysql.mysql /mydata/data/jiaowu/*\nmysql> ALTER TABLE jiaowu.tutor IMPORT TABLESPACE;\nQuery OK, 0 rows affected (0.00 sec)\nmysql> use jiaowu;\nDatabase changed\nmysql> select * from tutor;\n+------+---------------+--------+------+\n| TID  | Tname         | Gender | Age  |\n+------+---------------+--------+------+\n|    1 | ZhengYansheng | M      |   25 |\n|    2 | LiJian        | M      |   26 |\n|    3 | OuYangyu      | M      |   27 |\n|    4 | LuoChenghui   | M      |   25 |\n|    5 | LiuYunbo      | M      |   25 |\n|    6 | FuJian        | M      |   24 |\n|    7 | LiMenglu      | F      |   23 |\n|    8 | BaoYintu      | M      |   28 |\n|    9 | WangYana      | F      |   25 |\n|   11 | NULL          | NULL   | NULL |\n|   12 | NULL          | NULL   | NULL |\n|   13 | NULL          | NULL   | NULL |\n|   21 | NULL          | NULL   | NULL |\n|   22 | NULL          | NULL   | NULL |\n|   23 | NULL          | NULL   | NULL |\n+------+---------------+--------+------+\n15 rows in set (0.00 sec)\n\n#单表还原已经成功！结束。\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br")])]),n("p",[s._v("参考：\nhttp://467754239.blog.51cto.com/4878013/1621711")]),s._v(" "),n("p",[s._v("http://blog.51yip.com/mysql/1650.html")])])}),[],!1,null,null,null);a.default=t.exports}}]);