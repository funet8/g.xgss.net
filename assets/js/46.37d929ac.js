(window.webpackJsonp=window.webpackJsonp||[]).push([[46],{630:function(s,a,e){"use strict";e.r(a);var n=e(17),t=Object(n.a)({},(function(){var s=this,a=s.$createElement,e=s._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"在释放一个数亿记录的表时报该错"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#在释放一个数亿记录的表时报该错"}},[s._v("#")]),s._v(" 在释放一个数亿记录的表时报该错")]),s._v(" "),e("h2",{attrs:{id:"阿里云rds删除数据库过期报错"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#阿里云rds删除数据库过期报错"}},[s._v("#")]),s._v(" 阿里云RDS删除数据库过期报错：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("...\nerror\tCreating index 'PRIMARY' required more than 'innodb_online_alter_log_max_size' bytes of modification log. Please try again.\noptimize\tstatus\tOperation failed\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("p",[s._v("网上搜索问题")]),s._v(" "),e("p",[s._v("https://blog.csdn.net/hyzx_9987/article/details/112010324\n在释放一个数亿记录的表时报该错\nCreating index 'PRIMARY' required more than 'innodb_online_alter_log_max_size' bytes of modification")]),s._v(" "),e("p",[s._v("最大的在线创建索引修改日志文件大小")]),s._v(" "),e("p",[s._v("大致意思就是，当online_alter的时候，会将insert,update,delete的数据存在log中，log有个上限就是这个参数；如果alter花费了1小时，而在这1小时内的数据变更超过500M，那么就会失败；")]),s._v(" "),e("h2",{attrs:{id:"解决方案"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#解决方案"}},[s._v("#")]),s._v(" 解决方案")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("set global innodb_online_alter_log_max_size = 10737418240，调大该值；\n\nmysql> show variables like '%innodb_online_alter_log_max_size%';\n+----------------------------------+-----------+\n| Variable_name                    | Value     |\n+----------------------------------+-----------+\n| innodb_online_alter_log_max_size | 134217728 |\n+----------------------------------+-----------+\n1 row in set\n默认大小为128M\n\nset global innodb_online_alter_log_max_size=1073741824;\n设置为1024G\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br")])]),e("h2",{attrs:{id:"在阿里云rds中用命令行修改"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#在阿里云rds中用命令行修改"}},[s._v("#")]),s._v(" 在阿里云RDS中用命令行修改")]),s._v(" "),e("p",[s._v("无权限")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("mysql> set global innodb_online_alter_log_max_size=1073741824;\n1227 - Access denied; you need (at least one of) the SUPER privilege(s) for this operation\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[s._v("阿里云后台的'参数设置'修改提交，之后即可生效（非重启数据库）。")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://imgoss.xgss.net/picgo/image-20220510154650487.png?aliyun",alt:"image-20220510154650487"}})]),s._v(" "),e("p",[s._v("修成功")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("mysql> show variables like '%innodb_online_alter_log_max_size%';\n+----------------------------------+------------+\n| Variable_name                    | Value      |\n+----------------------------------+------------+\n| innodb_online_alter_log_max_size | 1073741824 |\n+----------------------------------+------------+\n1 row in set\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])])])}),[],!1,null,null,null);a.default=t.exports}}]);