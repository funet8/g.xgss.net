(window.webpackJsonp=window.webpackJsonp||[]).push([[241],{822:function(s,t,n){"use strict";n.r(t);var a=n(17),i=Object(a.a)({},(function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"gitbook-jenkins-github实现文档持续集成"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#gitbook-jenkins-github实现文档持续集成"}},[s._v("#")]),s._v(" Gitbook+Jenkins+Github实现文档持续集成")]),s._v(" "),n("h2",{attrs:{id:"需求说明"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#需求说明"}},[s._v("#")]),s._v(" 需求说明")]),s._v(" "),n("p",[s._v("为了搭建一个gitbook+github的团队协作文档系统，然后通过jenkins实现持续集成，也就是当你在gitlab上修改文档以后，jenkins会自动build此项目，这个时候你再通过浏览器访问就是修改后的内容。")]),s._v(" "),n("h2",{attrs:{id:"技术栈说明"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#技术栈说明"}},[s._v("#")]),s._v(" 技术栈说明")]),s._v(" "),n("p",[s._v("Gitbook： 是一个基于 Node.js 的命令行工具，可使用 Github/Git 和 Markdown 来制作精美的电子书，GitBook 并非关于 Git 的教程。")]),s._v(" "),n("p",[s._v("Jenkins：是一个开源软件项目，是基于Java开发的一种持续集成工具，用于监控持续重复的工作，旨在提供一个开放易用的软件平台，使软件项目可以进行持续集成 。")]),s._v(" "),n("p",[s._v("Github：是一个面向开源及私有软件项目的托管平台，因为只支持Git作为唯一的版本库格式进行托管，故名GitHub。")]),s._v(" "),n("h2",{attrs:{id:"系统说明"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#系统说明"}},[s._v("#")]),s._v(" 系统说明")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("系统： Centos7\n\nIP： 192.168.1.5(内网穿透、腾讯云服务器)\n\n域名： gitbook.xgss.net\n\ngithub:https://github.com/funet8/g.xgss.net.git\ngitee:https://gitee.com/funet8/g.xgss.net.git\n\nhttps://www.gitbook.com/\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("h1",{attrs:{id:"jenkins和github配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#jenkins和github配置"}},[s._v("#")]),s._v(" Jenkins和Github配置")]),s._v(" "),n("p",[s._v("写了这么多在说gitbook，现在说说一下jenkins，安装jenkins省略。")]),s._v(" "),n("h2",{attrs:{id:"重要前提"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#重要前提"}},[s._v("#")]),s._v(" 重要前提")]),s._v(" "),n("p",[s._v("1.GitHub收到提交的代码后要主动通知Jenkins，所以Jenkins所在服务器一定要有外网IP，否则GitHub无法访问，我的Jenkins服务器是部署在腾讯云的云主机上，带有外网IP（如果只有内网，那则需要用到内网穿透工具才能实现）；")]),s._v(" "),n("p",[s._v("2.本次实战要提交源码到GitHub，所以您需要有一个GitHub号，并在上面创建项目；")]),s._v(" "),n("p",[s._v("3.如果是内网的gitlab+jenkins则不需要有外网IP")]),s._v(" "),n("h2",{attrs:{id:"基本流程"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#基本流程"}},[s._v("#")]),s._v(" 基本流程")]),s._v(" "),n("p",[s._v("将编写的文件提交Github，Github通过Webhook钩子，通知执行jenkins，jenkins执行上线脚本或者构建动作，完成整个流程。")]),s._v(" "),n("h2",{attrs:{id:"新建jenkins任务"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#新建jenkins任务"}},[s._v("#")]),s._v(" 新建jenkins任务")]),s._v(" "),n("p",[s._v("回到主页 –> 新建任务 –> 新建一个自由风格的软件项目")]),s._v(" "),n("p",[n("img",{attrs:{src:"http://imgoss.xgss.net/picgo/image-20210909175533313.png?aliyunoss",alt:"image-20210909175533313"}})]),s._v(" "),n("p",[s._v("配置触发器")]),s._v(" "),n("p",[s._v("身份令牌这个可以随便写，尽量复杂一些")]),s._v(" "),n("p",[n("img",{attrs:{src:"http://imgoss.xgss.net/picgo/image-20210915182209327.png?aliyunoss",alt:"image-20210915182209327"}})]),s._v(" "),n("p",[s._v("生成钩子地址 JENKINS_URL/job/gitbook.xgss.net_github_online/build?token=TOKEN_NAME。将这个地址填写到github的项目webhook中。")]),s._v(" "),n("p",[s._v("http://0.0.0.0+端口/job/任务名/build?token=TOKEN值的链接")]),s._v(" "),n("h2",{attrs:{id:"构建执行脚本"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#构建执行脚本"}},[s._v("#")]),s._v(" 构建执行脚本")]),s._v(" "),n("p",[n("img",{attrs:{src:"http://imgoss.xgss.net/picgo/image-20210909182715587.png?aliyunoss",alt:"image-20210909182715587"}})]),s._v(" "),n("h2",{attrs:{id:"github-设置-webhooks"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#github-设置-webhooks"}},[s._v("#")]),s._v(" Github 设置 webhooks")]),s._v(" "),n("p",[s._v("进入GitHub上指定的项目 –> setting –> WebHooks&Services –> add webhook –> 输入刚刚部署地址")]),s._v(" "),n("p",[s._v("JENKINS_URL/job/gitbook.xgss.net_github_online/build?token=TOKEN_NAME")]),s._v(" "),n("p",[n("img",{attrs:{src:"http://imgoss.xgss.net/picgo/image-20210915182818437.png?aliyunoss",alt:"image-20210915182818437"}})]),s._v(" "),n("h2",{attrs:{id:"测试能否自动提交"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#测试能否自动提交"}},[s._v("#")]),s._v(" 测试能否自动提交")]),s._v(" "),n("p",[s._v("在git push看jenkins 能否自动执行。")]),s._v(" "),n("p",[s._v("有报错，在点击看具体的报错")]),s._v(" "),n("p",[n("img",{attrs:{src:"http://imgoss.xgss.net/picgo/image-20210915184202566.png?aliyunoss",alt:"image-20210915184202566"}})]),s._v(" "),n("p",[s._v("发现只能有get方法，post方法会报403")]),s._v(" "),n("p",[s._v("写了一个shell脚本每次写完自动提交，并且通知jenkins")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("# 提交\ngit add .\n\ngit commit -m \"提交修改文档\"\n\ngit push\n\n# webhook钩子\ncurl \"http://JENKINS_URL/job/项目名/build?token=密钥\"\n\n#修改以下参数\nSERVER='http://IP:8080'\nJob_Name='gitbook.xgss.net_github_online'\nToken='token123456'\nUSER='name'\nPassword='1234'\n\n#使用curl触发jenkins\ncurl --user $USER:${Password} ${SERVER}/job/${Job_Name}/build?token=${Token}\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br")])])])}),[],!1,null,null,null);t.default=i.exports}}]);